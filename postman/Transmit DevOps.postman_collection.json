{
	"info": {
		"_postman_id": "d87e1074-2e60-4973-9f5d-4a8ef95c6956",
		"name": "Transmit DevOps",
		"description": "API calls for Transmit Security based on server and client versions 2.18 and newer as indicated",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Ops - Export API tokens",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/api_tokens/actions/export",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"api_tokens",
						"actions",
						"export"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import API Tokens",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"items\": [\n   {\n      \"name\": \"demo2_token\",\n      \"hash\": \"7dMWPua5opVLQfL9+ln7YfAaf6tYZ7LFCWUAlMVSIMlRbF2+NrRJwfczkXlEx2G89J7e/Wr1CosyXrqkOfKhDg==\",\n      \"salt\": \"1126ca27-fa59-4540-b82e-c4c1541b380f\",\n      \"scopes\": [\n        \"auth-control-mobile-connect\",\n        \"auth-control-mobile-client\"\n      ]\n    }\n  ],\n  \"overwrite\": false\n}"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/api_tokens/actions/import",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"api_tokens",
						"actions",
						"import"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Create API token",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken 72f53b33-b728-4310-aeda-a0bca1dd2f1c; tid=dilithium"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"token\":\"demo\",\"name\":\"demo\",\"scopes\":[\"auth-control-mobile-client\",\"auth-control-approval-creator\",\"auth-control-user-manager\",\"auth-control-token-user\",\"auth-control-registrar\",\"auth-control-placeholder-manager\",\"auth-control-rest-client\",\"auth-control-status\",\"auth-control-mng\"],\"permissions\":[\"mng-ui-admin\"]}"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/api_tokens",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"api_tokens"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export Authentication Database",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/authproviders/actions/export",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"authproviders",
						"actions",
						"export"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import Authentication Database",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"items\" : [\n{\n            \"method\": \"pin_centralized\",\n            \"config_id\": \"longercentral-pin\",\n            \"length\": 8,\n            \"name\": \"central-pin\",\n            \"key\": \"******\"\n        }\n        ],\n\n    \"overwrite\": false\n}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/authproviders/actions/import",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"authproviders",
						"actions",
						"import"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export External Connectinos",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/external-connections/actions/export",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"external-connections",
						"actions",
						"export"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import External Connections",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"items\":[        {\n            \"provider_id\": \"sms-nexmo2\",\n            \"name\": \"sms-nexmo2newer\",\n            \"provider_type\": \"sms-nexmo\",\n            \"config\": {\n                \"nexmo\": {\n                    \"credentials_ref\": {\n                        \"alias\": \"sms-nexmo-a3656308-3ec8-4a4a-8a78-1f0f2fe0d982\",\n                        \"provider_type\": \"db\",\n                        \"type\": \"credentials\"\n                    },\n                    \"default_region\": \"US\",\n                    \"is_unicode\": false\n                },\n                \"type\": \"sms-nexmo\"\n            },\n            \"enabled\": true\n        }],\n\"overwrite\":true,\n\"type\":\"external_connections\"}"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/external-connections/actions/import",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"external-connections",
						"actions",
						"import"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export All Apps",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/applications/actions/export",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"applications",
						"actions",
						"export"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import Multiple Apps",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n        \"items\": [\n            {\n                \"data\": {\n                    \"token_config\": {\n                        \"trusted\": {\n                            \"provider_type\": \"db\",\n                            \"alias\": \"JwtCert\",\n                            \"type\": \"trusted\",\n                            \"version\": \"1\"\n                        },\n                        \"default_strategy\": \"sign\",\n                        \"expiry\": {\n                            \"act\": 3600,\n                            \"reg\": 1800,\n                            \"auth\": 1800,\n                            \"cfg\": 1800,\n                            \"pld\": 1800\n                        },\n                        \"type\": \"pki\",\n                        \"local\": {\n                            \"provider_type\": \"db\",\n                            \"alias\": \"JwtKey\",\n                            \"type\": \"local\",\n                            \"version\": \"1\"\n                        }\n                    },\n                    \"authenticators\": [\n                        {\n                            \"method\": \"otp\",\n                            \"level\": 4,\n                            \"provider_config\": {\n                                \"method\": \"otp\",\n                                \"config_id\": \"new1\"\n                            },\n                            \"category\": \"1808\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"password\",\n                            \"level\": 1,\n                            \"provider_config_id\": \"central-pw\",\n                            \"category\": \"6766\",\n                            \"enabled\": true\n                        }\n                    ],\n                    \"policies\": [\n                        {\n                            \"policy_id\": \"default_config\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"excluded\": [],\n                                            \"options\": [],\n                                            \"type\": \"configuration\",\n                                            \"included\": []\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Default Version\"\n                                }\n                            ],\n                            \"type\": \"config\",\n                            \"desc\": \"Authentication options screen\"\n                        },\n                        {\n                            \"policy_id\": \"default_reg\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Default Version\"\n                                }\n                            ],\n                            \"type\": \"reg\",\n                            \"desc\": \"Before registering a new authenticator\"\n                        },\n                        {\n                            \"policy_id\": \"default_unreg\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Default Version\"\n                                }\n                            ],\n                            \"type\": \"unreg\",\n                            \"desc\": \"Before deregistering an authenticator\"\n                        },\n                        {\n                            \"policy_id\": \"default_bind\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Default Version\"\n                                }\n                            ],\n                            \"type\": \"bind\",\n                            \"desc\": \"New device registration\"\n                        },\n                        {\n                            \"policy_id\": \"t1\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\",\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"channels\": [\n                                                            {\n                                                                \"type\": \"none\",\n                                                                \"target\": \"none\"\n                                                            },\n                                                            {\n                                                                \"from\": \"YourBank\",\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`asdf`\"\n                                                                },\n                                                                \"type\": \"sms\",\n                                                                \"target\": {\n                                                                    \"type\": \"static\",\n                                                                    \"value\": \"+16308411809\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"failures_strategy\": {\n                                                            \"type\": \"wrong_inputs_only\"\n                                                        },\n                                                        \"auto_execute\": true,\n                                                        \"otp_provider_id\": \"40d3a701-6de2-4c37-a23b-7d72c6a45daf\",\n                                                        \"type\": \"otp\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": true,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"default version\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true\n                            },\n                            \"desc\": \"t\"\n                        },\n                        {\n                            \"policy_id\": \"Login\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"pw1\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"PW login\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true\n                            },\n                            \"desc\": \"Login\"\n                        }\n                    ],\n                    \"type\": \"web\",\n                    \"version\": 16,\n                    \"procedures\": [],\n                    \"device_groups\": [],\n                    \"name\": \"new2\",\n                    \"crypto_session_config\": {\n                        \"mode\": \"off\"\n                    },\n                    \"id\": \"new2\",\n                    \"categories\": [\n                        {\n                            \"name\": \"Something you know\",\n                            \"id\": \"6766\"\n                        },\n                        {\n                            \"name\": \"Something you are\",\n                            \"id\": \"7960\"\n                        },\n                        {\n                            \"name\": \"Something you have\",\n                            \"id\": \"1808\"\n                        }\n                    ],\n                    \"fields\": null,\n                    \"providers\": {\n                        \"voice\": \"0e80ae3f-6e36-461d-9da8-960bbcb1cdc3\",\n                        \"sms\": \"09295c1e-195b-444c-9a3e-48df37bca914\",\n                        \"user\": \"local-user-provider\"\n                    },\n                    \"allowed_origins\": []\n                },\n                \"dependencies\": [],\n                \"constraints\": [\n                    {\n                        \"server_version\": \"4.0.2\",\n                        \"type\": \"server_version\"\n                    }\n                ]\n            }\n        ],\n        \"type\": \"application\",\n    \"overwrite\": false\n}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/applications/actions/import",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"applications",
						"actions",
						"import"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export Specific App",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application/actions/export?aid=new1",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application",
						"actions",
						"export"
					],
					"query": [
						{
							"key": "aid",
							"value": "new1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import Single App",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n         \"items\": [\n            {\n                \"data\": {\n                    \"token_config\": {\n                        \"expiry\": {\n                            \"act\": 1800,\n                            \"reg\": 1800,\n                            \"auth\": 1800,\n                            \"cfg\": 1800,\n                            \"pld\": 1800\n                        },\n                        \"secret\": {\n                            \"secret\": \"******\"\n                        },\n                        \"type\": \"hmac\"\n                    },\n                    \"device_management_config\": {},\n                    \"user_association_config\": {\n                        \"strategy\": {\n                            \"type\": \"user_id\"\n                        }\n                    },\n                    \"authenticators\": [\n                        {\n                            \"method\": \"password\",\n                            \"level\": 2,\n                            \"provider_config_id\": \"central-pw\",\n                            \"category\": \"765\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"placeholder_phpwd\",\n                            \"level\": 0,\n                            \"provider_config\": {\n                                \"initial_status\": \"unregistered\",\n                                \"method\": \"placeholder_phpwd\",\n                                \"config_id\": \"mobile_app\",\n                                \"manage_registration_per_device\": false,\n                                \"placeholder_type\": {\n                                    \"type\": \"internal\",\n                                    \"value\": \"password\"\n                                },\n                                \"allow_registration_without_token\": false\n                            },\n                            \"category\": \"765\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"question\",\n                            \"level\": 1,\n                            \"provider_config_id\": \"central-question\",\n                            \"category\": \"765\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"face_server\",\n                            \"level\": 6,\n                            \"provider_config_id\": \"ad82601e-5442-4aab-bb9c-a9965c890067\",\n                            \"category\": \"7908\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"pattern_centralized\",\n                            \"level\": 2,\n                            \"provider_config_id\": \"central-pattern\",\n                            \"category\": \"765\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"fingerprint\",\n                            \"level\": 6,\n                            \"provider_config\": {\n                                \"method\": \"fingerprint\",\n                                \"config_id\": \"mobile_app\"\n                            },\n                            \"category\": \"7908\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"voice_server\",\n                            \"level\": 6,\n                            \"provider_config_id\": \"VocalPass\",\n                            \"category\": \"7908\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"otp\",\n                            \"level\": 3,\n                            \"provider_config\": {\n                                \"method\": \"otp\",\n                                \"config_id\": \"mobile_app\"\n                            },\n                            \"category\": \"9595\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"pin\",\n                            \"level\": 3,\n                            \"provider_config\": {\n                                \"method\": \"pin\",\n                                \"config_id\": \"mobile_app\",\n                                \"length\": 4,\n                                \"key\": \"******\"\n                            },\n                            \"category\": \"765\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"method\": \"face_id\",\n                            \"level\": 5,\n                            \"provider_config\": {\n                                \"method\": \"face_id\",\n                                \"config_id\": \"mobile_app\"\n                            },\n                            \"category\": \"7908\",\n                            \"enabled\": true\n                        }\n                    ],\n                    \"florie_config\": {\n                        \"unlock\": [\n                            {\n                                \"condition\": {\n                                    \"type\": \"successful_authentication\"\n                                },\n                                \"scope\": {\n                                    \"type\": \"user\"\n                                }\n                            }\n                        ],\n                        \"failures_expiry_in_mins\": 10,\n                        \"lock\": [\n                            {\n                                \"condition\": {\n                                    \"max_failures\": 3,\n                                    \"method\": \"password\",\n                                    \"in_minutes\": 5,\n                                    \"type\": \"application_authenticator\"\n                                },\n                                \"action\": {\n                                    \"in_minutes\": 5,\n                                    \"type\": \"application_authenticator\"\n                                }\n                            },\n                            {\n                                \"condition\": {\n                                    \"max_failures\": 5,\n                                    \"method\": \"fingerprint\",\n                                    \"in_minutes\": 10,\n                                    \"type\": \"authenticator\"\n                                },\n                                \"action\": {\n                                    \"in_minutes\": 5,\n                                    \"type\": \"application_authenticator\"\n                                }\n                            }\n                        ]\n                    },\n                    \"policies\": [\n                        {\n                            \"policy_id\": \"default_auth\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"start_in_menu\": true,\n                                                    \"update_default\": false,\n                                                    \"start_with\": \"menu\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"sso_level\": \"os\",\n                                            \"min_auth_level\": 3,\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"sso_window\"\n                                            },\n                                            \"application_ids\": [\n                                                \"newmobile\"\n                                            ],\n                                            \"type\": \"sso_window\",\n                                            \"window_in_seconds\": 300\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Default Version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"id1\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"default finger\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\",\n                                            \"cor\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"List of auth choices\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"channels\": [\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"language\": {\n                                                                        \"type\": \"static\",\n                                                                        \"value\": \"en-AU\"\n                                                                    },\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Here is your code: %otp%,,,, Once more, your code is: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"voice\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"subject\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Login code`\"\n                                                                    },\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Here is your code: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"email\",\n                                                                    \"target\": {\n                                                                        \"type\": \"static\",\n                                                                        \"value\": \"[kurt@transmitsecurity.com, kurt@transmitsecurity.net]\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`use: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"sms\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"failures_strategy\": {\n                                                                \"type\": \"wrong_inputs_only\"\n                                                            },\n                                                            \"auto_execute\": false,\n                                                            \"otp_provider_id\": \"otp-internal-hotp\",\n                                                            \"otp_provider_config\": {\n                                                                \"length\": 4\n                                                            },\n                                                            \"type\": \"otp\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_id\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pin_centralized\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"check if FP not enrolled\",\n                                                \"type\": \"authenticator_status\"\n                                            },\n                                            \"method\": [\n                                                \"fingerprint\"\n                                            ],\n                                            \"and\": false,\n                                            \"type\": \"authenticator_status\",\n                                            \"status\": \"unregistered\"\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"List of auth choices\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\",\n                                                            \"fallback\": {\n                                                                \"threshold\": 4\n                                                            }\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_id\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"channels\": [\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"language\": {\n                                                                        \"type\": \"static\",\n                                                                        \"value\": \"en-AU\"\n                                                                    },\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Here is your code: %otp%,,,, Once more, your code is: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"voice\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"subject\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Login code`\"\n                                                                    },\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Here is your code: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"email\",\n                                                                    \"target\": {\n                                                                        \"type\": \"static\",\n                                                                        \"value\": \"[kurt@transmitsecurity.com, kurt@transmitsecurity.net]\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`use: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"sms\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"failures_strategy\": {\n                                                                \"type\": \"wrong_inputs_only\"\n                                                            },\n                                                            \"auto_execute\": false,\n                                                            \"otp_provider_id\": \"otp-internal-hotp\",\n                                                            \"otp_provider_config\": {\n                                                                \"length\": 4\n                                                            },\n                                                            \"type\": \"otp\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pin_centralized\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pattern_centralized\",\n                                                            \"fallback\": {\n                                                                \"threshold\": 3\n                                                            }\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"start_in_menu\": true,\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"menu\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Promote FP\",\n                                                        \"type\": \"registration_promotion\"\n                                                    },\n                                                    \"strategies\": [\n                                                        {\n                                                            \"type\": \"frequency_logins\",\n                                                            \"value\": 1\n                                                        }\n                                                    ],\n                                                    \"methods\": [\n                                                        {\n                                                            \"silent\": false,\n                                                            \"method\": \"fingerprint\"\n                                                        }\n                                                    ],\n                                                    \"minimal_fulfill\": true,\n                                                    \"ok_button\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Yes Please`\"\n                                                    },\n                                                    \"decline_button\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`No Thanks`\"\n                                                    },\n                                                    \"register_at_least\": 1,\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Please enroll for TouchID`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`New Biometric`\"\n                                                    },\n                                                    \"type\": \"registration_promotion\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"jul13options\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Auth options and drive FP reg\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Default Auth\"\n                        },\n                        {\n                            \"policy_id\": \"default_config\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"excluded\": [],\n                                            \"metadata\": {\n                                                \"type\": \"configuration\"\n                                            },\n                                            \"options\": [\n                                                {\n                                                    \"method\": \"pattern_centralized\"\n                                                },\n                                                {\n                                                    \"method\": \"voice_server\"\n                                                },\n                                                {\n                                                    \"method\": \"question\"\n                                                },\n                                                {\n                                                    \"method\": \"fingerprint\"\n                                                },\n                                                {\n                                                    \"method\": \"placeholder_phpass\"\n                                                },\n                                                {\n                                                    \"method\": \"placeholder_fp\"\n                                                },\n                                                {\n                                                    \"method\": \"password\"\n                                                },\n                                                {\n                                                    \"method\": \"placeholder_test ph\"\n                                                },\n                                                {\n                                                    \"method\": \"placeholder_ep\"\n                                                },\n                                                {\n                                                    \"method\": \"face_server\"\n                                                },\n                                                {\n                                                    \"method\": \"otp\"\n                                                },\n                                                {\n                                                    \"method\": \"pin_centralized\"\n                                                },\n                                                {\n                                                    \"method\": \"face_id\"\n                                                }\n                                            ],\n                                            \"type\": \"configuration\",\n                                            \"included\": []\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"Default Version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"excluded\": [],\n                                            \"metadata\": {\n                                                \"label\": \"no ph\",\n                                                \"type\": \"configuration\"\n                                            },\n                                            \"options\": [\n                                                {\n                                                    \"method\": \"voice_server\"\n                                                },\n                                                {\n                                                    \"method\": \"fingerprint\"\n                                                },\n                                                {\n                                                    \"method\": \"placeholder_phpass\",\n                                                    \"hide_register\": true,\n                                                    \"hide_unregister\": true,\n                                                    \"hide_reregister\": true\n                                                },\n                                                {\n                                                    \"method\": \"placeholder_test ph\",\n                                                    \"hide_register\": true,\n                                                    \"hide_unregister\": true,\n                                                    \"hide_reregister\": true\n                                                },\n                                                {\n                                                    \"method\": \"placeholder_ep\",\n                                                    \"hide_register\": true,\n                                                    \"hide_unregister\": true,\n                                                    \"hide_reregister\": true\n                                                },\n                                                {\n                                                    \"method\": \"face_server\"\n                                                },\n                                                {\n                                                    \"method\": \"face_id\",\n                                                    \"hide_register\": false\n                                                }\n                                            ],\n                                            \"type\": \"configuration\",\n                                            \"included\": [\n                                                \"voice_server\",\n                                                \"fingerprint\",\n                                                \"placeholder_phpass\",\n                                                \"placeholder_test ph\",\n                                                \"placeholder_ep\",\n                                                \"face_server\",\n                                                \"face_id\"\n                                            ]\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"id1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"LimitedOptions\"\n                                }\n                            ],\n                            \"type\": \"config\",\n                            \"desc\": \"Default Management Menu\"\n                        },\n                        {\n                            \"policy_id\": \"default_reg\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"Default Version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": true,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"id1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Reg\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"QR to email\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"channels\": [\n                                                            {\n                                                                \"subject\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Please scan to enroll authenticator`\"\n                                                                },\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Please scan with your mobile app to complete enrollment`\"\n                                                                },\n                                                                \"type\": \"email\",\n                                                                \"target\": {\n                                                                    \"type\": \"user\",\n                                                                    \"value\": \"$.email\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"failures_strategy\": {\n                                                            \"type\": \"wrong_inputs_only\"\n                                                        },\n                                                        \"otp_provider_id\": \"qr\",\n                                                        \"type\": \"otp\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"idqr\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Reg after QR\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"Code to registered mobile\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"channels\": [\n                                                            {\n                                                                \"from\": \"Your Bank\",\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Please enter code %otp% to complete enrollment`\"\n                                                                },\n                                                                \"type\": \"sms\",\n                                                                \"target\": {\n                                                                    \"type\": \"user\",\n                                                                    \"value\": \"$.mobile\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"failures_strategy\": {\n                                                            \"type\": \"wrong_inputs_only\"\n                                                        },\n                                                        \"otp_provider_id\": \"otp-internal-hotp\",\n                                                        \"otp_provider_config\": {\n                                                            \"length\": 6\n                                                        },\n                                                        \"type\": \"otp\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"idotp\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Register after OTP\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"information\"\n                                            },\n                                            \"text\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"`${@policy.request()}`\"\n                                            },\n                                            \"button_text\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"`Continue`\"\n                                            },\n                                            \"title\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"`Information`\"\n                                            },\n                                            \"type\": \"information\",\n                                            \"parameters\": []\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"reg3\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Eval what reg\"\n                                }\n                            ],\n                            \"type\": \"reg\",\n                            \"desc\": \"Before registering a new authenticator\"\n                        },\n                        {\n                            \"policy_id\": \"Login\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"FP\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"start_in_menu\": true,\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"menu\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"os_type\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"request\",\n                                                \"value\": \"$.collection_result.content.device_details.os_type\"\n                                            },\n                                            \"data_type\": \"string\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \"contains\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": \"Android\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"PW\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"first\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"id1\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"Pw\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"channels\": [\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Please use the following OTP code: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"sms\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"failures_strategy\": {\n                                                                \"type\": \"wrong_inputs_only\"\n                                                            },\n                                                            \"otp_provider_id\": \"otp-internal-hotp\",\n                                                            \"otp_provider_config\": {\n                                                                \"length\": 4\n                                                            },\n                                                            \"type\": \"otp\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"secondary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": false,\n                                                        \"start_with\": \"default\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"secondary_new_method\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"cryptographic_device_binding\",\n                                                \"siblingId\": 5319\n                                            },\n                                            \"check\": [\n                                                \"registered\"\n                                            ],\n                                            \"type\": \"device_fingerprint\"\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Inform- device not trusted\",\n                                                        \"type\": \"information\"\n                                                    },\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Device not trusted`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Continue`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Information`\"\n                                                    },\n                                                    \"type\": \"information\",\n                                                    \"parameters\": []\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pattern_centralized\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"fingerprint\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"voice_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"default\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            },\n                                            \"condition\": {\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"device_trust_score\"\n                                                },\n                                                \"threshold\": 0.5,\n                                                \"type\": \"device_trust_score\"\n                                            },\n                                            \"true_branch\": {\n                                                \"false_branch\": {\n                                                    \"false_branch\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": true,\n                                                                \"start_with\": \"default\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    },\n                                                    \"condition\": {\n                                                        \"sso_level\": \"application\",\n                                                        \"min_auth_level\": 3,\n                                                        \"negated\": false,\n                                                        \"metadata\": {\n                                                            \"type\": \"sso_window\"\n                                                        },\n                                                        \"application_ids\": [\n                                                            \"umobile_app\"\n                                                        ],\n                                                        \"type\": \"sso_window\",\n                                                        \"window_in_seconds\": 300\n                                                    },\n                                                    \"true_branch\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"notes\": \"Not in registered location\",\n                                                                \"label\": \"Inform- Not in home location\",\n                                                                \"type\": \"information\"\n                                                            },\n                                                            \"text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`You will be asked to authenticate because you are not in your home location`\"\n                                                            },\n                                                            \"button_text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Continue`\"\n                                                            },\n                                                            \"title\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Information`\"\n                                                            },\n                                                            \"type\": \"information\",\n                                                            \"parameters\": []\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"biometric or pw\",\n                                                                    \"type\": \"primary_authentication_menu\"\n                                                                },\n                                                                \"methods\": [\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"fingerprint\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"voice_server\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"pattern_centralized\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"face_server\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"password\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"options\": {\n                                                                    \"update_default\": true,\n                                                                    \"start_with\": \"default\"\n                                                                },\n                                                                \"strategy\": {\n                                                                    \"type\": \"primary\"\n                                                                },\n                                                                \"type\": \"authentication\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    },\n                                                    \"type\": \"condition\"\n                                                },\n                                                \"condition\": {\n                                                    \"negated\": false,\n                                                    \"metadata\": {\n                                                        \"type\": \"location_match\",\n                                                        \"siblingId\": 7958\n                                                    },\n                                                    \"scale\": \"state\",\n                                                    \"type\": \"location_match\",\n                                                    \"value\": {\n                                                        \"type\": \"user\",\n                                                        \"value\": \"$.home_address\"\n                                                    }\n                                                },\n                                                \"true_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Inform- location trusted\",\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`You've been logged in because your device is trusted and you are in your trusted location`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Location Trust`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                },\n                                                \"otherwise_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Inform- no location data\",\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`You will be asked for a Biometric authentication because your location is turned off`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Information`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Biometric only\",\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_id\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"voice_server\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": true,\n                                                                \"start_with\": \"default\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                },\n                                                \"type\": \"condition\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Goodbye`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Exit`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Rejected`\"\n                                                    }\n                                                },\n                                                \"clear_session\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"id4\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Location and trust auto-login\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"listed_locations\",\n                                                \"siblingId\": 3921\n                                            },\n                                            \"listed_locations\": [\n                                                {\n                                                    \"country\": \"US\",\n                                                    \"city\": \"Pleasanton\",\n                                                    \"state\": \"CA\"\n                                                },\n                                                {\n                                                    \"country\": \"US\",\n                                                    \"city\": \"San Francisco\",\n                                                    \"state\": \"CA\"\n                                                }\n                                            ],\n                                            \"type\": \"listed_locations\"\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"voice_server\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"condition\": {\n                                                \"trust\": 0.5,\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"location_profile\"\n                                                },\n                                                \"scale\": \"spot\",\n                                                \"radius\": 100,\n                                                \"type\": \"location_profile\"\n                                            },\n                                            \"true_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"otherwise_branch\": {\n                                                \"action\": {\n                                                    \"dialog\": {\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`bye`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Exit`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Rejected`\"\n                                                        }\n                                                    },\n                                                    \"clear_session\": false,\n                                                    \"metadata\": {\n                                                        \"type\": \"reject\"\n                                                    },\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"id8\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"fixed location\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Auth with list of authenticators\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pattern_centralized\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pin_centralized\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_id\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"start_in_menu\": true,\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"menu\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Is fingerprint/TouchID supported?\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"!@policy.request().collection_result.content.capabilities.finger_print_supported \\t\"\n                                            },\n                                            \"data_type\": \"boolean\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \"==\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": true\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Auth with list of authenticators\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pin_centralized\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"voice_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_id\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"condition\": {\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"authenticator_status\",\n                                                    \"siblingId\": 543\n                                                },\n                                                \"method\": [\n                                                    \"fingerprint\"\n                                                ],\n                                                \"and\": false,\n                                                \"type\": \"authenticator_status\",\n                                                \"status\": \"unregistered\"\n                                            },\n                                            \"true_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"auth with PW\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"first\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"cancel_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`No thanks`\"\n                                                        },\n                                                        \"metadata\": {\n                                                            \"declaredVarTypes\": [\n                                                                {\n                                                                    \"type_descriptor\": {\n                                                                        \"schema\": {\n                                                                            \"properties\": {\n                                                                                \"user_input\": {\n                                                                                    \"type\": \"string\"\n                                                                                }\n                                                                            }\n                                                                        },\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"name\": \"enroll\"\n                                                                }\n                                                            ],\n                                                            \"label\": \"Ask user to enroll FP yes/no\",\n                                                            \"type\": \"confirmation\"\n                                                        },\n                                                        \"continue_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Sign me up!`\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please enroll your fingerprint so you don't need your password anymore`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Confirm`\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"variable_name\": \"enroll\",\n                                                            \"type\": \"continue\"\n                                                        },\n                                                        \"type\": \"confirmation\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Enroll FP\",\n                                                                \"type\": \"registration\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"silent\": false,\n                                                                    \"method\": \"fingerprint\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"registration\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"Success message\",\n                                                                    \"type\": \"information\"\n                                                                },\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Congratulations, you can now login with your fingerprint`\"\n                                                                },\n                                                                \"button_text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Continue`\"\n                                                                },\n                                                                \"title\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Success`\"\n                                                                },\n                                                                \"type\": \"information\",\n                                                                \"parameters\": []\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"jun22\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Drive FP enroll\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"false_branch\": {\n                                                \"debug_id\": \"70fbf8aa-61a8-4b2a-a931-a1cc5d5c696e\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \" Authenticate\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"channels\": [\n                                                                    {\n                                                                        \"from\": \"Transmit\",\n                                                                        \"language\": {\n                                                                            \"type\": \"static\",\n                                                                            \"value\": \"en-AU\"\n                                                                        },\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Here is your code: %otp%,,,, Once more, your code is: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"voice\",\n                                                                        \"target\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"@legacyField(\\\"user\\\", \\\"$.mobile\\\")\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"subject\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Login code`\"\n                                                                        },\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Here is your code: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"email\",\n                                                                        \"target\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"[\\\"kurt@transmitsecurity.com\\\", \\\"kurt@transmitsecurity.net\\\"]\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"from\": \"Transmit\",\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`use: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"sms\",\n                                                                        \"target\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"@legacyField(\\\"user\\\", \\\"$.mobile\\\")\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"failures_strategy\": {\n                                                                    \"type\": \"wrong_inputs_only\"\n                                                                },\n                                                                \"auto_execute\": false,\n                                                                \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                \"otp_provider_config\": {\n                                                                    \"length\": 4\n                                                                },\n                                                                \"type\": \"otp\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"voice_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_id\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pin\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"debug_id\": \"1a1c4fb5-d6dd-4c55-b201-d54cfa3a9774\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"debug_id\": \"55e7c9f6-f6dd-4352-a5b9-3268a59db980\",\n                                            \"condition\": {\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"label\": \"check if FP not enrolled\",\n                                                    \"type\": \"authenticator_status\"\n                                                },\n                                                \"method\": [\n                                                    \"fingerprint\"\n                                                ],\n                                                \"and\": false,\n                                                \"type\": \"authenticator_status\",\n                                                \"status\": \"unregistered\"\n                                            },\n                                            \"true_branch\": {\n                                                \"debug_id\": \"276d9676-6f7d-40fb-9482-d4fc284e1a34\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"List of auth choices\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\",\n                                                                \"fallback\": {\n                                                                    \"threshold\": 4\n                                                                }\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"voice_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_id\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"channels\": [\n                                                                    {\n                                                                        \"from\": \"Transmit\",\n                                                                        \"language\": {\n                                                                            \"type\": \"static\",\n                                                                            \"value\": \"en-AU\"\n                                                                        },\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Here is your code: %otp%,,,, Once more, your code is: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"voice\",\n                                                                        \"target\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"@legacyField(\\\"user\\\", \\\"$.mobile\\\")\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"subject\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Login code`\"\n                                                                        },\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Here is your code: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"email\",\n                                                                        \"target\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"[\\\"kurt@transmitsecurity.com\\\", \\\"kurt@transmitsecurity.net\\\"]\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"from\": \"Transmit\",\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`use: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"sms\",\n                                                                        \"target\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"@legacyField(\\\"user\\\", \\\"$.mobile\\\")\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"failures_strategy\": {\n                                                                    \"type\": \"wrong_inputs_only\"\n                                                                },\n                                                                \"auto_execute\": false,\n                                                                \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                \"otp_provider_config\": {\n                                                                    \"length\": 4\n                                                                },\n                                                                \"type\": \"otp\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pin\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"debug_id\": \"4abc425d-3a51-440b-8326-fa91ca23a2bd\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Promote FP\",\n                                                            \"type\": \"registration_promotion\"\n                                                        },\n                                                        \"strategies\": [\n                                                            {\n                                                                \"type\": \"frequency_logins\",\n                                                                \"value\": 1\n                                                            }\n                                                        ],\n                                                        \"methods\": [\n                                                            {\n                                                                \"silent\": false,\n                                                                \"method\": \"fingerprint\"\n                                                            }\n                                                        ],\n                                                        \"minimal_fulfill\": true,\n                                                        \"ok_button\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Yes Please`\"\n                                                        },\n                                                        \"decline_button\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`No Thanks`\"\n                                                        },\n                                                        \"register_at_least\": 1,\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please enroll for TouchID`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`New Biometric`\"\n                                                        },\n                                                        \"type\": \"registration_promotion\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"debug_id\": \"4eff592d-dc5a-4c57-963f-8266698abce1\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"debug_id\": \"9a7679e6-c456-4761-a5b6-e17f429bcdf2\",\n                                        \"condition\": {\n                                            \"sso_level\": \"os\",\n                                            \"min_auth_level\": 0,\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"sso_window\"\n                                            },\n                                            \"application_ids\": [\n                                                \"standalone_mobile\"\n                                            ],\n                                            \"type\": \"sso_window\",\n                                            \"window_in_seconds\": 600\n                                        },\n                                        \"true_branch\": {\n                                            \"debug_id\": \"fa24c30f-dc77-41c6-ab30-174ffbb53f6b\",\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"jul13options\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Auth options and drive FP reg\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"provision_totp\"\n                                                },\n                                                \"config_id\": \"default\",\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Check totp provisioned\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"@policy.device().totp.provisioned \\t\\n\"\n                                            },\n                                            \"data_type\": \"boolean\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \"==\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": true\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"id5\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Provision Soft Token\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"metadata\": {\n                                            \"node_type\": \"generic\",\n                                            \"type\": \"generic_condition\"\n                                        },\n                                        \"field\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"@policy.user().id\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"List of auth choices\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\",\n                                                            \"fallback\": {\n                                                                \"threshold\": 4\n                                                            }\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_id\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"channels\": [\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"language\": {\n                                                                        \"type\": \"static\",\n                                                                        \"value\": \"en-AU\"\n                                                                    },\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Here is your code: %otp%,,,, Once more, your code is: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"voice\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"subject\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Login code`\"\n                                                                    },\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Here is your code: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"email\",\n                                                                    \"target\": {\n                                                                        \"type\": \"static\",\n                                                                        \"value\": \"[kurt@transmitsecurity.com, kurt@transmitsecurity.net]\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`use: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"sms\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"failures_strategy\": {\n                                                                \"type\": \"wrong_inputs_only\"\n                                                            },\n                                                            \"auto_execute\": false,\n                                                            \"otp_provider_id\": \"otp-internal-hotp\",\n                                                            \"otp_provider_config\": {\n                                                                \"length\": 4\n                                                            },\n                                                            \"type\": \"otp\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pin_centralized\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pattern_centralized\",\n                                                            \"fallback\": {\n                                                                \"threshold\": 3\n                                                            }\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"start_in_menu\": true,\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"menu\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"false_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                },\n                                                \"condition\": {\n                                                    \"negated\": false,\n                                                    \"metadata\": {\n                                                        \"label\": \"Is biometric not registered?\",\n                                                        \"type\": \"authenticator_status\"\n                                                    },\n                                                    \"method\": [\n                                                        \"fingerprint\"\n                                                    ],\n                                                    \"and\": false,\n                                                    \"type\": \"authenticator_status\",\n                                                    \"status\": \"unregistered\"\n                                                },\n                                                \"true_branch\": {\n                                                    \"action\": {\n                                                        \"cancel_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Exit`\"\n                                                        },\n                                                        \"metadata\": {\n                                                            \"declaredVarTypes\": [\n                                                                {\n                                                                    \"type_descriptor\": {\n                                                                        \"schema\": {\n                                                                            \"properties\": {\n                                                                                \"user_input\": {\n                                                                                    \"type\": \"string\"\n                                                                                }\n                                                                            }\n                                                                        },\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"name\": \"confirm\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"confirmation\"\n                                                        },\n                                                        \"continue_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Confirm`\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please register for a new authentication method and get rid of passwords`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Confirm`\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"variable_name\": \"confirm\",\n                                                            \"type\": \"continue\"\n                                                        },\n                                                        \"type\": \"confirmation\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"registration\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"silent\": false,\n                                                                    \"method\": \"fingerprint\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"registration\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                },\n                                                \"type\": \"condition\"\n                                            }\n                                        },\n                                        \"matched_branches\": [\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"generic_condition\"\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"demo\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                },\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"pw only\",\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"default\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            }\n                                        ],\n                                        \"type\": \"match_case\"\n                                    },\n                                    \"version_id\": \"id2\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Auth options with biometric reg\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"new\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"Set state primary\",\n                                                \"type\": \"custom_device_data\"\n                                            },\n                                            \"data\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"{\\\"state\\\":\\\"primary\\\"}\"\n                                            },\n                                            \"scope\": \"device\",\n                                            \"type\": \"custom_data\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"field\": {\n                                                \"type\": \"custom_device_data\",\n                                                \"value\": \"$.login\"\n                                            },\n                                            \"otherwise_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"declaredVarTypes\": [\n                                                            {\n                                                                \"type_descriptor\": {\n                                                                    \"schema\": {\n                                                                        \"properties\": {\n                                                                            \"method\": {\n                                                                                \"type\": \"string\"\n                                                                            },\n                                                                            \"level\": {\n                                                                                \"type\": \"int\"\n                                                                            },\n                                                                            \"raw_data\": {\n                                                                                \"type\": \"object\"\n                                                                            }\n                                                                        }\n                                                                    },\n                                                                    \"type\": \"object\"\n                                                                },\n                                                                \"name\": \"authused\"\n                                                            }\n                                                        ],\n                                                        \"label\": \"Give List\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\",\n                                                    \"var_name\": \"authused\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"set default to auth used\",\n                                                            \"type\": \"custom_device_data\"\n                                                        },\n                                                        \"data\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"{\\\"login\\\":authused.method}\"\n                                                        },\n                                                        \"scope\": \"device\",\n                                                        \"type\": \"custom_data\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            },\n                                            \"matched_branches\": [\n                                                {\n                                                    \"matcher\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Chk login default\",\n                                                            \"type\": \"internal_device_db\",\n                                                            \"siblingId\": 7136\n                                                        },\n                                                        \"data_type\": \"string\",\n                                                        \"type\": \"generic_operation\",\n                                                        \"value\": {\n                                                            \"type\": \"static\",\n                                                            \"value\": \"password\"\n                                                        },\n                                                        \"operation\": \"==\"\n                                                    },\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"declaredVarTypes\": [\n                                                                    {\n                                                                        \"type_descriptor\": {\n                                                                            \"schema\": {\n                                                                                \"properties\": {\n                                                                                    \"method\": {\n                                                                                        \"type\": \"string\"\n                                                                                    },\n                                                                                    \"level\": {\n                                                                                        \"type\": \"int\"\n                                                                                    },\n                                                                                    \"raw_data\": {\n                                                                                        \"type\": \"object\"\n                                                                                    }\n                                                                                }\n                                                                            },\n                                                                            \"type\": \"object\"\n                                                                        },\n                                                                        \"name\": \"authused\"\n                                                                    }\n                                                                ],\n                                                                \"label\": \"Password\",\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"password\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": true,\n                                                                \"start_with\": \"first\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\",\n                                                            \"var_name\": \"authused\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"set default to auth used\",\n                                                                    \"type\": \"custom_device_data\"\n                                                                },\n                                                                \"data\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"{\\\"login\\\":authused.method}\"\n                                                                },\n                                                                \"scope\": \"device\",\n                                                                \"type\": \"custom_data\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    }\n                                                },\n                                                {\n                                                    \"matcher\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Chk login default\",\n                                                            \"type\": \"internal_device_db\",\n                                                            \"siblingId\": 7136\n                                                        },\n                                                        \"data_type\": \"string\",\n                                                        \"type\": \"generic_operation\",\n                                                        \"value\": {\n                                                            \"type\": \"static\",\n                                                            \"value\": \"fingerprint\"\n                                                        },\n                                                        \"operation\": \"==\"\n                                                    },\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"declaredVarTypes\": [\n                                                                    {\n                                                                        \"type_descriptor\": {\n                                                                            \"schema\": {\n                                                                                \"properties\": {\n                                                                                    \"method\": {\n                                                                                        \"type\": \"string\"\n                                                                                    },\n                                                                                    \"level\": {\n                                                                                        \"type\": \"int\"\n                                                                                    },\n                                                                                    \"raw_data\": {\n                                                                                        \"type\": \"object\"\n                                                                                    }\n                                                                                }\n                                                                            },\n                                                                            \"type\": \"object\"\n                                                                        },\n                                                                        \"name\": \"authused\"\n                                                                    }\n                                                                ],\n                                                                \"label\": \"Fingerprint\",\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"password\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": true,\n                                                                \"start_with\": \"first\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\",\n                                                            \"var_name\": \"authused\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"set default to auth used\",\n                                                                    \"type\": \"custom_device_data\"\n                                                                },\n                                                                \"data\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"{\\\"login\\\":authused.method}\"\n                                                                },\n                                                                \"scope\": \"device\",\n                                                                \"type\": \"custom_data\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            ],\n                                            \"type\": \"match_case\"\n                                        }\n                                    },\n                                    \"version_id\": \"wfl1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Primary setting default\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"totp\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"check if device ID is pending disable totp\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"@policy.user().custom_data.droptotp == @policy.device().device_id\"\n                                            },\n                                            \"data_type\": \"boolean\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \"==\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": true\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"disable_totp\"\n                                                },\n                                                \"type\": \"disable_totp\",\n                                                \"config_ids\": [\n                                                    \"default\"\n                                                ]\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"clear droptotp field\",\n                                                        \"type\": \"custom_user_data\"\n                                                    },\n                                                    \"data\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"{\\\"droptotp\\\":\\\"\\\"}\"\n                                                    },\n                                                    \"scope\": \"user\",\n                                                    \"type\": \"custom_data\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"default\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            }\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"totp1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Clear totp\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"registration\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"silent\": false,\n                                                        \"method\": \"fingerprint\"\n                                                    }\n                                                ],\n                                                \"type\": \"registration\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"sep21\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"FP enroll\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"lock\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"PW auth\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"florie_locked\"\n                                            },\n                                            \"type\": \"florie_locked\"\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"information\"\n                                                },\n                                                \"text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Your account is locked, please provide the recovery code on the next screen`\"\n                                                },\n                                                \"button_text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Continue`\"\n                                                },\n                                                \"title\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Information`\"\n                                                },\n                                                \"type\": \"information\",\n                                                \"parameters\": []\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Temp access code\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"channels\": [],\n                                                                \"failures_strategy\": {\n                                                                    \"type\": \"wrong_inputs_only\"\n                                                                },\n                                                                \"auto_execute\": false,\n                                                                \"otp_provider_id\": \"otp-temporary-access-code\",\n                                                                \"otp_provider_config\": {\n                                                                    \"length\": 6,\n                                                                    \"type\": \"numeric\"\n                                                                },\n                                                                \"type\": \"otp\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"default\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"PW auth\",\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"default\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            }\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"PW auth\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"lockv1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"If user locked out- recovery\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"sally\",\n                                            \"john\",\n                                            \"bob\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"metadata\": {\n                                            \"node_type\": \"generic\",\n                                            \"type\": \"generic_condition\"\n                                        },\n                                        \"field\": {\n                                            \"type\": \"user\",\n                                            \"value\": \"$.group\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`You are not permitted to access this application [err.group ${@policy.identityStore().group} not allowed]`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Exit`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Rejected`\"\n                                                    }\n                                                },\n                                                \"clear_session\": true,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"matched_branches\": [\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"node_type\": \"generic\",\n                                                        \"type\": \"generic_condition\"\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"accountant\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                },\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"PW first\",\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"default\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"false_branch\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"Inform biometric auth enroll\",\n                                                                    \"type\": \"information\"\n                                                                },\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`You are required to enroll a biometric authenticator for this device.  First confirm your device in the next screen:`\"\n                                                                },\n                                                                \"button_text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Continue`\"\n                                                                },\n                                                                \"title\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Information`\"\n                                                                },\n                                                                \"type\": \"information\",\n                                                                \"parameters\": []\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"metadata\": {\n                                                                        \"label\": \"OTP\",\n                                                                        \"type\": \"primary_authentication_menu\"\n                                                                    },\n                                                                    \"methods\": [\n                                                                        {\n                                                                            \"method\": {\n                                                                                \"channels\": [\n                                                                                    {\n                                                                                        \"from\": \"TheCompany\",\n                                                                                        \"text\": {\n                                                                                            \"type\": \"expression\",\n                                                                                            \"value\": \"`Please use code %otp%`\"\n                                                                                        },\n                                                                                        \"type\": \"sms\",\n                                                                                        \"target\": {\n                                                                                            \"type\": \"user\",\n                                                                                            \"value\": \"$.mobile\"\n                                                                                        }\n                                                                                    }\n                                                                                ],\n                                                                                \"failures_strategy\": {\n                                                                                    \"type\": \"wrong_inputs_only\"\n                                                                                },\n                                                                                \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                                \"otp_provider_config\": {\n                                                                                    \"length\": 6\n                                                                                },\n                                                                                \"type\": \"otp\"\n                                                                            }\n                                                                        }\n                                                                    ],\n                                                                    \"options\": {\n                                                                        \"update_default\": true,\n                                                                        \"start_with\": \"default\"\n                                                                    },\n                                                                    \"strategy\": {\n                                                                        \"type\": \"primary\"\n                                                                    },\n                                                                    \"type\": \"authentication\"\n                                                                },\n                                                                \"type\": \"action\",\n                                                                \"child\": {\n                                                                    \"action\": {\n                                                                        \"metadata\": {\n                                                                            \"label\": \"Register touch/face/fp\",\n                                                                            \"type\": \"registration\"\n                                                                        },\n                                                                        \"methods\": [\n                                                                            {\n                                                                                \"silent\": false,\n                                                                                \"method\": \"fingerprint\"\n                                                                            },\n                                                                            {\n                                                                                \"silent\": false,\n                                                                                \"method\": \"face_id\"\n                                                                            }\n                                                                        ],\n                                                                        \"type\": \"registration\"\n                                                                    },\n                                                                    \"type\": \"action\",\n                                                                    \"child\": {\n                                                                        \"action\": {\n                                                                            \"type\": \"auth_pass\"\n                                                                        },\n                                                                        \"type\": \"action\"\n                                                                    }\n                                                                }\n                                                            }\n                                                        },\n                                                        \"condition\": {\n                                                            \"negated\": false,\n                                                            \"metadata\": {\n                                                                \"label\": \"Check if biometric registered for device\",\n                                                                \"type\": \"authenticator_status\"\n                                                            },\n                                                            \"method\": [\n                                                                \"fingerprint\",\n                                                                \"face_id\",\n                                                                \"face_server\"\n                                                            ],\n                                                            \"and\": false,\n                                                            \"type\": \"authenticator_status\",\n                                                            \"status\": \"registered\"\n                                                        },\n                                                        \"true_branch\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"Biometric auth\",\n                                                                    \"type\": \"primary_authentication_menu\"\n                                                                },\n                                                                \"methods\": [\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"fingerprint\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"face_id\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"face_server\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"pattern_centralized\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"options\": {\n                                                                    \"start_in_menu\": true,\n                                                                    \"update_default\": true,\n                                                                    \"start_with\": \"menu\"\n                                                                },\n                                                                \"strategy\": {\n                                                                    \"type\": \"primary\"\n                                                                },\n                                                                \"type\": \"authentication\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        },\n                                                        \"type\": \"condition\"\n                                                    }\n                                                }\n                                            },\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"generic_condition\"\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"client\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                },\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Choice of auth\",\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"fingerprint\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_id\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"voice_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pattern_centralized\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"start_in_menu\": true,\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"menu\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            }\n                                        ],\n                                        \"type\": \"match_case\"\n                                    },\n                                    \"version_id\": \"abac1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Auth by attribute\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"information\"\n                                                },\n                                                \"text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`${@policy.request().collection_result.content}`\"\n                                                },\n                                                \"button_text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Continue`\"\n                                                },\n                                                \"title\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Information`\"\n                                                },\n                                                \"type\": \"information\",\n                                                \"parameters\": []\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"redirect_to_journey\"\n                                                    },\n                                                    \"policy_id\": \"default_auth\",\n                                                    \"params\": [],\n                                                    \"type\": \"redirect\",\n                                                    \"redirect_type\": \"invoke\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"rdir1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Auth then redir to reg\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"provision_totp\"\n                                                },\n                                                \"config_id\": \"default\",\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"metadata\": {\n                                                    \"type\": \"procedure\"\n                                                },\n                                                \"procedure_id\": \"810b5ca9-b347-4d14-aca1-78b6a681ae18\",\n                                                \"type\": \"procedure\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"scan1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Login then scan userless login\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"john\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"PW\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"first\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Check number of mobile devices bound gt 1\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"@std.len(@policy.boundDevices(\\\"mobile_app\\\"))\"\n                                            },\n                                            \"data_type\": \"integer\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \">\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": \"1\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Too many mobile devices registered, please remove one in support portal`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Exit`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Rejected`\"\n                                                    }\n                                                },\n                                                \"clear_session\": true,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`otherwise`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Exit`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Rejected`\"\n                                                    }\n                                                },\n                                                \"clear_session\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"limit1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Limit mobile\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"static\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"channels\": [\n                                                                {\n                                                                    \"from\": \"Transmit\",\n                                                                    \"text\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"`Please use the following OTP code: %otp%`\"\n                                                                    },\n                                                                    \"type\": \"sms\",\n                                                                    \"target\": {\n                                                                        \"type\": \"user\",\n                                                                        \"value\": \"$.mobile\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"failures_strategy\": {\n                                                                \"type\": \"wrong_inputs_only\"\n                                                            },\n                                                            \"otp_provider_id\": \"otp-internal-hotp\",\n                                                            \"otp_provider_config\": {\n                                                                \"length\": 4\n                                                            },\n                                                            \"type\": \"otp\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"secondary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": false,\n                                                        \"start_with\": \"default\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"secondary_new_method\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"cryptographic_device_binding\",\n                                                \"siblingId\": 5319\n                                            },\n                                            \"check\": [\n                                                \"registered\"\n                                            ],\n                                            \"type\": \"device_fingerprint\"\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Inform- device not trusted\",\n                                                        \"type\": \"information\"\n                                                    },\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Device not trusted`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Continue`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Information`\"\n                                                    },\n                                                    \"type\": \"information\",\n                                                    \"parameters\": []\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pattern_centralized\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"fingerprint\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"voice_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"default\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            },\n                                            \"condition\": {\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"device_trust_score\"\n                                                },\n                                                \"threshold\": 0.6,\n                                                \"type\": \"device_trust_score\"\n                                            },\n                                            \"true_branch\": {\n                                                \"false_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"notes\": \"Not in registered location\",\n                                                            \"label\": \"Inform- Not in trusted location\",\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`You will be asked to authenticate because you are not in a trusted location, score: ${@risk.locationTrust(\\\"spot\\\",1000)}`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Information`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"biometric or pw\",\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"voice_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"pattern_centralized\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"password\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": true,\n                                                                \"start_with\": \"default\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                },\n                                                \"condition\": {\n                                                    \"trust\": 0.7,\n                                                    \"negated\": false,\n                                                    \"metadata\": {\n                                                        \"type\": \"location_profile\"\n                                                    },\n                                                    \"scale\": \"spot\",\n                                                    \"radius\": 1000,\n                                                    \"type\": \"location_profile\"\n                                                },\n                                                \"true_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Inform- location trusted\",\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`You've been logged in because your device is trusted and you are in your trusted location, score: ${@risk.locationTrust(\\\"spot\\\",1000)}`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Location Trust`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                },\n                                                \"otherwise_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Inform- no location data\",\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`You will be asked for a Biometric authentication because your location is turned off`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Information`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Biometric only\",\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_id\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"voice_server\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": true,\n                                                                \"start_with\": \"default\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                },\n                                                \"type\": \"condition\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Goodbye`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Exit`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Rejected`\"\n                                                    }\n                                                },\n                                                \"clear_session\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"locv2\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Location profiled\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_id\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pattern_centralized\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pin_centralized\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": true,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"registration_promotion\"\n                                                },\n                                                \"strategies\": [\n                                                    {\n                                                        \"type\": \"frequency_logins\",\n                                                        \"value\": 1\n                                                    }\n                                                ],\n                                                \"methods\": [\n                                                    {\n                                                        \"silent\": false,\n                                                        \"method\": \"face_id\"\n                                                    },\n                                                    {\n                                                        \"silent\": false,\n                                                        \"method\": \"fingerprint\"\n                                                    }\n                                                ],\n                                                \"minimal_fulfill\": true,\n                                                \"ok_button\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`OK`\"\n                                                },\n                                                \"decline_button\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`No thanks`\"\n                                                },\n                                                \"register_at_least\": 1,\n                                                \"text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Would you like to enroll a biometric`\"\n                                                },\n                                                \"title\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Enroll`\"\n                                                },\n                                                \"type\": \"registration_promotion\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"false_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"provision_totp\"\n                                                        },\n                                                        \"config_id\": \"default\",\n                                                        \"type\": \"provision_totp\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                },\n                                                \"condition\": {\n                                                    \"negated\": false,\n                                                    \"metadata\": {\n                                                        \"label\": \"check totp\",\n                                                        \"type\": \"generic_condition\"\n                                                    },\n                                                    \"field\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"@policy.device().totp.provisioned\"\n                                                    },\n                                                    \"data_type\": \"boolean\",\n                                                    \"type\": \"generic\",\n                                                    \"operation\": \"==\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": true\n                                                    }\n                                                },\n                                                \"true_branch\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                },\n                                                \"type\": \"condition\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"fpcap1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"test enroll eval device\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Primary login\"\n                        },\n                        {\n                            \"policy_id\": \"Transfer\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\",\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"secondary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"voice_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pattern_centralized\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": false,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"time_window\": 300,\n                                                \"type\": \"secondary_new_method\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"false_branch\": {\n                                                \"debug_id\": \"ce34f113-b76c-41c1-8f24-c581edc2136e\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Finger\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_id\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"debug_id\": \"b030f24c-948a-4e1c-b8ff-f4fc421236fd\",\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"debug_id\": \"6ba63ef4-c9d6-4c4c-8c35-b069ba8d5354\",\n                                            \"condition\": {\n                                                \"sso_level\": \"application\",\n                                                \"min_auth_level\": 2,\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"sso_window\"\n                                                },\n                                                \"type\": \"sso_window\",\n                                                \"window_in_seconds\": 60\n                                            },\n                                            \"true_branch\": {\n                                                \"debug_id\": \"305e4e7c-6ced-42cb-988e-43641c901b9b\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"debug_id\": \"fe502ed2-fae9-44cc-a370-963b7701ca6f\",\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Check amount\",\n                                                \"type\": \"generic_request\",\n                                                \"siblingId\": 2440\n                                            },\n                                            \"field\": {\n                                                \"type\": \"request\",\n                                                \"value\": \"$.params.amount\"\n                                            },\n                                            \"data_type\": \"integer\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \">=\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": \"1000\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"debug_id\": \"768bb4eb-6ca5-4a9b-8daf-bd9f081431e9\",\n                                                \"metadata\": {\n                                                    \"type\": \"generic_condition\"\n                                                },\n                                                \"field\": {\n                                                    \"type\": \"custom_device_data\",\n                                                    \"value\": \"$.transfer\"\n                                                },\n                                                \"otherwise_branch\": {\n                                                    \"debug_id\": \"f7a84067-041d-42ac-bc9c-ac92c6ba2d94\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"declaredVarTypes\": [\n                                                                {\n                                                                    \"type_descriptor\": {\n                                                                        \"schema\": {\n                                                                            \"properties\": {\n                                                                                \"method\": {\n                                                                                    \"type\": \"string\"\n                                                                                },\n                                                                                \"level\": {\n                                                                                    \"type\": \"int\"\n                                                                                },\n                                                                                \"raw_data\": {\n                                                                                    \"type\": \"object\"\n                                                                                }\n                                                                            }\n                                                                        },\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"name\": \"authused\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"secondary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pin_centralized\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"fingerprint\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pattern_centralized\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_id\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"start_in_menu\": true,\n                                                            \"update_default\": false,\n                                                            \"start_with\": \"menu\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"secondary_new_method\"\n                                                        },\n                                                        \"type\": \"authentication\",\n                                                        \"var_name\": \"authused\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"debug_id\": \"44db5cb3-62df-4de0-bff3-1a7a64d786a1\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"custom_device_data\"\n                                                            },\n                                                            \"data\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"{\\\"transfer\\\":authused.method}\"\n                                                            },\n                                                            \"scope\": \"device\",\n                                                            \"type\": \"custom_data\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"debug_id\": \"c646b860-2055-4ff1-92a3-e192c05c80cf\",\n                                                            \"action\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                },\n                                                \"matched_branches\": [\n                                                    {\n                                                        \"matcher\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"generic_condition\"\n                                                            },\n                                                            \"data_type\": \"string\",\n                                                            \"type\": \"generic_operation\",\n                                                            \"value\": {\n                                                                \"type\": \"static\",\n                                                                \"value\": \"pattern_centralized\"\n                                                            },\n                                                            \"operation\": \"==\"\n                                                        },\n                                                        \"child\": {\n                                                            \"debug_id\": \"2dc51809-0e98-4c23-b0e2-fb2630878a18\",\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"declaredVarTypes\": [\n                                                                        {\n                                                                            \"type_descriptor\": {\n                                                                                \"schema\": {\n                                                                                    \"properties\": {\n                                                                                        \"method\": {\n                                                                                            \"type\": \"string\"\n                                                                                        },\n                                                                                        \"level\": {\n                                                                                            \"type\": \"int\"\n                                                                                        },\n                                                                                        \"raw_data\": {\n                                                                                            \"type\": \"object\"\n                                                                                        }\n                                                                                    }\n                                                                                },\n                                                                                \"type\": \"object\"\n                                                                            },\n                                                                            \"name\": \"authused\"\n                                                                        }\n                                                                    ],\n                                                                    \"type\": \"secondary_authentication_menu\"\n                                                                },\n                                                                \"methods\": [\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"pattern_centralized\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"pin_centralized\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"password\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"fingerprint\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"face_server\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"face_id\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"options\": {\n                                                                    \"update_default\": false,\n                                                                    \"start_with\": \"default\"\n                                                                },\n                                                                \"strategy\": {\n                                                                    \"type\": \"secondary_new_method\"\n                                                                },\n                                                                \"type\": \"authentication\",\n                                                                \"var_name\": \"authused\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"debug_id\": \"4ddb04f7-5f21-4091-8457-67ae51af9392\",\n                                                                \"action\": {\n                                                                    \"metadata\": {\n                                                                        \"type\": \"custom_device_data\"\n                                                                    },\n                                                                    \"data\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"{\\\"transfer\\\":authused.method}\"\n                                                                    },\n                                                                    \"scope\": \"device\",\n                                                                    \"type\": \"custom_data\"\n                                                                },\n                                                                \"type\": \"action\",\n                                                                \"child\": {\n                                                                    \"debug_id\": \"dc10271b-d406-4d83-8f69-5112927054cf\",\n                                                                    \"action\": {\n                                                                        \"type\": \"auth_pass\"\n                                                                    },\n                                                                    \"type\": \"action\"\n                                                                }\n                                                            }\n                                                        }\n                                                    },\n                                                    {\n                                                        \"matcher\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"generic_condition\"\n                                                            },\n                                                            \"data_type\": \"string\",\n                                                            \"type\": \"generic_operation\",\n                                                            \"value\": {\n                                                                \"type\": \"static\",\n                                                                \"value\": \"fingerprint\"\n                                                            },\n                                                            \"operation\": \"==\"\n                                                        },\n                                                        \"child\": {\n                                                            \"debug_id\": \"1fa22893-1b12-47ab-aea6-1807a5f6fde0\",\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"declaredVarTypes\": [\n                                                                        {\n                                                                            \"type_descriptor\": {\n                                                                                \"schema\": {\n                                                                                    \"properties\": {\n                                                                                        \"method\": {\n                                                                                            \"type\": \"string\"\n                                                                                        },\n                                                                                        \"level\": {\n                                                                                            \"type\": \"int\"\n                                                                                        },\n                                                                                        \"raw_data\": {\n                                                                                            \"type\": \"object\"\n                                                                                        }\n                                                                                    }\n                                                                                },\n                                                                                \"type\": \"object\"\n                                                                            },\n                                                                            \"name\": \"authused\"\n                                                                        }\n                                                                    ],\n                                                                    \"type\": \"secondary_authentication_menu\"\n                                                                },\n                                                                \"methods\": [\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"fingerprint\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"pin_centralized\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"password\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"face_server\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"pattern_centralized\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"method\": {\n                                                                            \"type\": \"face_id\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"options\": {\n                                                                    \"update_default\": false,\n                                                                    \"start_with\": \"first\"\n                                                                },\n                                                                \"strategy\": {\n                                                                    \"type\": \"secondary_new_method\"\n                                                                },\n                                                                \"type\": \"authentication\",\n                                                                \"var_name\": \"authused\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"debug_id\": \"d56582bc-6564-4953-8aa6-7cca088b11c9\",\n                                                                \"action\": {\n                                                                    \"metadata\": {\n                                                                        \"type\": \"custom_device_data\"\n                                                                    },\n                                                                    \"data\": {\n                                                                        \"type\": \"expression\",\n                                                                        \"value\": \"{\\\"transfer\\\":authused.method}\"\n                                                                    },\n                                                                    \"scope\": \"device\",\n                                                                    \"type\": \"custom_data\"\n                                                                },\n                                                                \"type\": \"action\",\n                                                                \"child\": {\n                                                                    \"debug_id\": \"fabf8ba9-bc73-4167-9ca6-bb680ad1bcfa\",\n                                                                    \"action\": {\n                                                                        \"type\": \"auth_pass\"\n                                                                    },\n                                                                    \"type\": \"action\"\n                                                                }\n                                                            }\n                                                        }\n                                                    }\n                                                ],\n                                                \"type\": \"match_case\"\n                                            },\n                                            \"debug_id\": \"a60daa89-663c-41ef-9ae6-198005702c80\",\n                                            \"condition\": {\n                                                \"sso_level\": \"application\",\n                                                \"min_auth_level\": 5,\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"sso_window\"\n                                                },\n                                                \"type\": \"sso_window\",\n                                                \"window_in_seconds\": 180\n                                            },\n                                            \"true_branch\": {\n                                                \"debug_id\": \"6ecf3d3f-fea3-4449-a86a-52a30f0308fc\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"secondary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"channels\": [\n                                                                    {\n                                                                        \"from\": \"Your Company\",\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Please use code %otp%`\"\n                                                                        },\n                                                                        \"type\": \"sms\",\n                                                                        \"target\": {\n                                                                            \"type\": \"user\",\n                                                                            \"value\": \"$.mobile\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"failures_strategy\": {\n                                                                    \"type\": \"wrong_inputs_only\"\n                                                                },\n                                                                \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                \"otp_provider_config\": {\n                                                                    \"length\": 6\n                                                                },\n                                                                \"type\": \"otp\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_id\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": false,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"time_window\": 30,\n                                                        \"type\": \"secondary_new_method\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"debug_id\": \"9017cdfa-d448-42e8-b300-2c411dcb37bb\",\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"debug_id\": \"5b67bae1-7f83-462a-9e2a-59ce236026c5\",\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Sorry`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"``\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Blocked`\"\n                                                    }\n                                                },\n                                                \"clear_session\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"transfer1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Transfer with conditional auth\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"cor\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"idd2\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"auth pass\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"new\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"field\": {\n                                            \"type\": \"custom_device_data\",\n                                            \"value\": \"$.state\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"field\": {\n                                                \"type\": \"custom_device_data\",\n                                                \"value\": \"$.transfer\"\n                                            },\n                                            \"otherwise_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"declaredVarTypes\": [\n                                                            {\n                                                                \"type_descriptor\": {\n                                                                    \"schema\": {\n                                                                        \"properties\": {\n                                                                            \"method\": {\n                                                                                \"type\": \"string\"\n                                                                            },\n                                                                            \"level\": {\n                                                                                \"type\": \"int\"\n                                                                            },\n                                                                            \"raw_data\": {\n                                                                                \"type\": \"object\"\n                                                                            }\n                                                                        }\n                                                                    },\n                                                                    \"type\": \"object\"\n                                                                },\n                                                                \"name\": \"authused\"\n                                                            }\n                                                        ],\n                                                        \"label\": \"Give List\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": false,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\",\n                                                    \"var_name\": \"authused\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"set default to auth used and set state steppedup\",\n                                                            \"type\": \"custom_device_data\"\n                                                        },\n                                                        \"data\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"{\\\"transfer\\\":authused.method,\\\"state\\\":\\\"steppedup\\\"}\"\n                                                        },\n                                                        \"scope\": \"device\",\n                                                        \"type\": \"custom_data\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            },\n                                            \"matched_branches\": [\n                                                {\n                                                    \"matcher\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Chk trnsfr default\",\n                                                            \"type\": \"internal_device_db\",\n                                                            \"siblingId\": 7118\n                                                        },\n                                                        \"data_type\": \"string\",\n                                                        \"type\": \"generic_operation\",\n                                                        \"value\": {\n                                                            \"type\": \"static\",\n                                                            \"value\": \"pattern_centralized\"\n                                                        },\n                                                        \"operation\": \"==\"\n                                                    },\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"declaredVarTypes\": [\n                                                                    {\n                                                                        \"type_descriptor\": {\n                                                                            \"schema\": {\n                                                                                \"properties\": {\n                                                                                    \"method\": {\n                                                                                        \"type\": \"string\"\n                                                                                    },\n                                                                                    \"level\": {\n                                                                                        \"type\": \"int\"\n                                                                                    },\n                                                                                    \"raw_data\": {\n                                                                                        \"type\": \"object\"\n                                                                                    }\n                                                                                }\n                                                                            },\n                                                                            \"type\": \"object\"\n                                                                        },\n                                                                        \"name\": \"authused\"\n                                                                    }\n                                                                ],\n                                                                \"label\": \"Pattern\",\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"pattern_centralized\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": false,\n                                                                \"start_with\": \"first\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\",\n                                                            \"var_name\": \"authused\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"set default to auth used and set state steppedup\",\n                                                                    \"type\": \"custom_device_data\"\n                                                                },\n                                                                \"data\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"{\\\"transfer\\\":authused.method,\\\"state\\\":\\\"steppedup\\\"}\"\n                                                                },\n                                                                \"scope\": \"device\",\n                                                                \"type\": \"custom_data\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    }\n                                                },\n                                                {\n                                                    \"matcher\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"Chk trnsfr default\",\n                                                            \"type\": \"internal_device_db\",\n                                                            \"siblingId\": 7118\n                                                        },\n                                                        \"data_type\": \"string\",\n                                                        \"type\": \"generic_operation\",\n                                                        \"value\": {\n                                                            \"type\": \"static\",\n                                                            \"value\": \"fingerprint\"\n                                                        },\n                                                        \"operation\": \"==\"\n                                                    },\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"declaredVarTypes\": [\n                                                                    {\n                                                                        \"type_descriptor\": {\n                                                                            \"schema\": {\n                                                                                \"properties\": {\n                                                                                    \"method\": {\n                                                                                        \"type\": \"string\"\n                                                                                    },\n                                                                                    \"level\": {\n                                                                                        \"type\": \"int\"\n                                                                                    },\n                                                                                    \"raw_data\": {\n                                                                                        \"type\": \"object\"\n                                                                                    }\n                                                                                }\n                                                                            },\n                                                                            \"type\": \"object\"\n                                                                        },\n                                                                        \"name\": \"authused\"\n                                                                    }\n                                                                ],\n                                                                \"label\": \"FP\",\n                                                                \"type\": \"primary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"pattern_centralized\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": false,\n                                                                \"start_with\": \"first\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"primary\"\n                                                            },\n                                                            \"type\": \"authentication\",\n                                                            \"var_name\": \"authused\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"set default to auth used and set state steppedup\",\n                                                                    \"type\": \"custom_device_data\"\n                                                                },\n                                                                \"data\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"{\\\"transfer\\\":authused.method,\\\"state\\\":\\\"steppedup\\\"}\"\n                                                                },\n                                                                \"scope\": \"device\",\n                                                                \"type\": \"custom_data\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            ],\n                                            \"type\": \"match_case\"\n                                        },\n                                        \"matched_branches\": [\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"StepUp State\",\n                                                        \"type\": \"internal_device_db\",\n                                                        \"siblingId\": 6185\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"steppedup\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                },\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        ],\n                                        \"type\": \"match_case\"\n                                    },\n                                    \"version_id\": \"wf1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"State and default check\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"false_branch\": {\n                                                \"debug_id\": \"b8e9e52a-3ba5-41f0-99ef-e169fff2abe8\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Finger\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"default\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"debug_id\": \"10d2740d-faf2-402e-b6a8-0fb8eb432886\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"debug_id\": \"cba42a01-aa50-4fc5-8b0c-e6fe71ed4ffe\",\n                                            \"condition\": {\n                                                \"sso_level\": \"application\",\n                                                \"min_auth_level\": 2,\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"sso_window\"\n                                                },\n                                                \"type\": \"sso_window\",\n                                                \"window_in_seconds\": 300\n                                            },\n                                            \"true_branch\": {\n                                                \"debug_id\": \"c50befae-cbf1-4c94-8c88-8c11ecdc6017\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"debug_id\": \"b8aee039-3a15-416a-9eba-6a4a11afb537\",\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Check amount\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"@legacyField(\\\"request\\\", \\\"$.params.amount\\\")\"\n                                            },\n                                            \"data_type\": \"integer\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \">=\",\n                                            \"value\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"\\\"1000\\\"\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"false_branch\": {\n                                                    \"debug_id\": \"31c19c7d-f911-4cce-a4ef-4a831a982856\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"secondary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pattern_centralized\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"fingerprint\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_id\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pin\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"start_in_menu\": true,\n                                                            \"update_default\": false,\n                                                            \"start_with\": \"menu\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"time_window\": 300,\n                                                            \"type\": \"secondary_new_method\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"debug_id\": \"37a7ec7a-9a20-4650-beee-080fb731635a\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                },\n                                                \"debug_id\": \"2efe7297-0668-4544-a9f9-ebe4a0d337ef\",\n                                                \"condition\": {\n                                                    \"negated\": false,\n                                                    \"metadata\": {\n                                                        \"type\": \"location_enabled\"\n                                                    },\n                                                    \"field\": {\n                                                        \"type\": \"request\",\n                                                        \"value\": \"$.collection_result.content.location.enabled\"\n                                                    },\n                                                    \"data_type\": \"boolean\",\n                                                    \"type\": \"generic\",\n                                                    \"operation\": \"==\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": true\n                                                    }\n                                                },\n                                                \"true_branch\": {\n                                                    \"debug_id\": \"2452fd2f-48c2-4f45-ae37-2162a78783f5\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"fingerprint\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_id\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pattern_centralized\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"password\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"face_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"voice_server\"\n                                                                }\n                                                            },\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"pin\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": true,\n                                                            \"start_with\": \"first\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"debug_id\": \"e0475a30-20a8-4fcc-b0d3-f7095d7292b0\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                },\n                                                \"type\": \"condition\"\n                                            },\n                                            \"debug_id\": \"0bc5463b-771d-4935-9371-6e9f5afe7c9f\",\n                                            \"condition\": {\n                                                \"sso_level\": \"application\",\n                                                \"min_auth_level\": 6,\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"sso_window\"\n                                                },\n                                                \"type\": \"sso_window\",\n                                                \"window_in_seconds\": 30\n                                            },\n                                            \"true_branch\": {\n                                                \"debug_id\": \"1298e3d6-3b13-4452-b274-6753b731a0ab\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"debug_id\": \"0ea238dc-d3fa-4d73-8bf0-731e46548942\",\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Sorry`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Bye`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Blocked`\"\n                                                    }\n                                                },\n                                                \"clear_session\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"cond3\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Second factors with location enabled\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"false_branch\": {\n                                                \"debug_id\": \"3ba0a9a2-be63-4e8f-84d9-c42997e5aea9\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Finger\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_id\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"debug_id\": \"7e1a09e4-09e8-4d8c-8db8-cdea7975d726\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"debug_id\": \"c9bb0fed-44c3-43b0-a254-83569252be9d\",\n                                            \"condition\": {\n                                                \"sso_level\": \"application\",\n                                                \"min_auth_level\": 2,\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"sso_window\"\n                                                },\n                                                \"type\": \"sso_window\",\n                                                \"window_in_seconds\": 60\n                                            },\n                                            \"true_branch\": {\n                                                \"debug_id\": \"fcefb547-abcf-43ba-95fb-af4bd170870f\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"debug_id\": \"5e6aefe0-a15b-4f73-a1a7-e8f326e55e29\",\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Check if large amount\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"@legacyField(\\\"request\\\", \\\"$.params.amount\\\")\"\n                                            },\n                                            \"data_type\": \"integer\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \">=\",\n                                            \"value\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"\\\"1000\\\"\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"debug_id\": \"1395dc87-3901-4b4b-bd91-9ecbb077bab3\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"debug_id\": \"33ea5871-e21d-41de-9184-c4366f6ad3a7\",\n                                            \"condition\": {\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"label\": \"High Risk check\",\n                                                    \"type\": \"generic_condition\"\n                                                },\n                                                \"field\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"@webrequests.WebSvcRisk(\\\"1\\\").transformed_data.risk\"\n                                                },\n                                                \"data_type\": \"integer\",\n                                                \"type\": \"generic\",\n                                                \"operation\": \">\",\n                                                \"value\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"\\\"200\\\"\"\n                                                }\n                                            },\n                                            \"true_branch\": {\n                                                \"false_branch\": {\n                                                    \"debug_id\": \"1bd55d90-2b4e-4d34-9fd7-fb1ae774a1c4\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`High value, high risk, no recent strong auth`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Information`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"debug_id\": \"afe8dc03-93eb-4f59-849b-3225a1c9a110\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Strong auth different category\",\n                                                                \"type\": \"secondary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"password\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_id\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"channels\": [\n                                                                            {\n                                                                                \"from\": \"Company\",\n                                                                                \"text\": {\n                                                                                    \"type\": \"expression\",\n                                                                                    \"value\": \"`Your code %otp%`\"\n                                                                                },\n                                                                                \"type\": \"sms\",\n                                                                                \"target\": {\n                                                                                    \"type\": \"expression\",\n                                                                                    \"value\": \"@legacyField(\\\"user\\\", \\\"$.mobile\\\")\"\n                                                                                }\n                                                                            }\n                                                                        ],\n                                                                        \"failures_strategy\": {\n                                                                            \"type\": \"wrong_inputs_only\"\n                                                                        },\n                                                                        \"auto_execute\": false,\n                                                                        \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                        \"otp_provider_config\": {\n                                                                            \"length\": 6\n                                                                        },\n                                                                        \"type\": \"otp\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"start_in_menu\": true,\n                                                                \"update_default\": false,\n                                                                \"start_with\": \"menu\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"secondary_new_category\"\n                                                            },\n                                                            \"type\": \"authentication\",\n                                                            \"var_name\": \"authused\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"debug_id\": \"4d98bf3c-c4c9-462e-a8fe-d7c57b8fbb25\",\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                },\n                                                \"debug_id\": \"bff2ed6f-8b2a-4c81-b9d9-045f44ea0bb5\",\n                                                \"condition\": {\n                                                    \"sso_level\": \"application\",\n                                                    \"min_auth_level\": 5,\n                                                    \"negated\": false,\n                                                    \"metadata\": {\n                                                        \"label\": \"Recent strong auth?\",\n                                                        \"type\": \"sso_window\"\n                                                    },\n                                                    \"type\": \"sso_window\",\n                                                    \"window_in_seconds\": 180\n                                                },\n                                                \"true_branch\": {\n                                                    \"debug_id\": \"78ac2e6d-ca5b-487e-9d27-45ee0a6d4bf5\",\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`High value, high risk, recent strong auth`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Information`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"debug_id\": \"e38d6df4-d2b6-469c-9a97-76bae1c8c660\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"secondary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"pattern_centralized\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"channels\": [\n                                                                            {\n                                                                                \"from\": \"Your Company\",\n                                                                                \"text\": {\n                                                                                    \"type\": \"expression\",\n                                                                                    \"value\": \"`Please use code %otp%`\"\n                                                                                },\n                                                                                \"type\": \"sms\",\n                                                                                \"target\": {\n                                                                                    \"type\": \"expression\",\n                                                                                    \"value\": \"@legacyField(\\\"user\\\", \\\"$.mobile\\\")\"\n                                                                                }\n                                                                            }\n                                                                        ],\n                                                                        \"failures_strategy\": {\n                                                                            \"type\": \"wrong_inputs_only\"\n                                                                        },\n                                                                        \"auto_execute\": false,\n                                                                        \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                        \"otp_provider_config\": {\n                                                                            \"length\": 6\n                                                                        },\n                                                                        \"type\": \"otp\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_id\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"password\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"start_in_menu\": true,\n                                                                \"update_default\": false,\n                                                                \"start_with\": \"menu\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"time_window\": 30,\n                                                                \"type\": \"secondary_new_method\"\n                                                            },\n                                                            \"type\": \"authentication\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"debug_id\": \"dcbeed03-56bb-41a4-b380-fb603a723a7e\",\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                },\n                                                \"type\": \"condition\"\n                                            },\n                                            \"otherwise_branch\": {\n                                                \"debug_id\": \"be756af6-5a00-4e46-a603-2b39d4c810c5\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"information\"\n                                                    },\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`No risk data`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Continue`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Information`\"\n                                                    },\n                                                    \"type\": \"information\",\n                                                    \"parameters\": []\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"false_branch\": {\n                                                        \"debug_id\": \"b477826b-3f11-4018-ab12-e349cb0a6d91\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Strong auth different category\",\n                                                                \"type\": \"secondary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"password\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_id\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"update_default\": false,\n                                                                \"start_with\": \"first\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"type\": \"secondary_new_method\"\n                                                            },\n                                                            \"type\": \"authentication\",\n                                                            \"var_name\": \"authused\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"debug_id\": \"c4e1d8c0-acd3-47e9-9a93-871e74179e36\",\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    },\n                                                    \"debug_id\": \"8f692613-dd0b-4de5-b6b9-5f72b0902fb3\",\n                                                    \"condition\": {\n                                                        \"sso_level\": \"application\",\n                                                        \"min_auth_level\": 5,\n                                                        \"negated\": false,\n                                                        \"metadata\": {\n                                                            \"label\": \"Recent strong auth?\",\n                                                            \"type\": \"sso_window\"\n                                                        },\n                                                        \"type\": \"sso_window\",\n                                                        \"window_in_seconds\": 180\n                                                    },\n                                                    \"true_branch\": {\n                                                        \"debug_id\": \"8896ba61-734f-46ea-8f88-21200347b28d\",\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"secondary_authentication_menu\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"pattern_centralized\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"fingerprint\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"channels\": [\n                                                                            {\n                                                                                \"from\": \"Your Company\",\n                                                                                \"text\": {\n                                                                                    \"type\": \"expression\",\n                                                                                    \"value\": \"`Please use code %otp%`\"\n                                                                                },\n                                                                                \"type\": \"sms\",\n                                                                                \"target\": {\n                                                                                    \"type\": \"expression\",\n                                                                                    \"value\": \"@legacyField(\\\"user\\\", \\\"$.mobile\\\")\"\n                                                                                }\n                                                                            }\n                                                                        ],\n                                                                        \"failures_strategy\": {\n                                                                            \"type\": \"wrong_inputs_only\"\n                                                                        },\n                                                                        \"auto_execute\": false,\n                                                                        \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                        \"otp_provider_config\": {\n                                                                            \"length\": 6\n                                                                        },\n                                                                        \"type\": \"otp\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_id\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"face_server\"\n                                                                    }\n                                                                },\n                                                                {\n                                                                    \"method\": {\n                                                                        \"type\": \"password\"\n                                                                    }\n                                                                }\n                                                            ],\n                                                            \"options\": {\n                                                                \"start_in_menu\": true,\n                                                                \"update_default\": false,\n                                                                \"start_with\": \"menu\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"time_window\": 30,\n                                                                \"type\": \"secondary_new_method\"\n                                                            },\n                                                            \"type\": \"authentication\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"debug_id\": \"f75ac432-52e9-416e-ab33-4741627e904b\",\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    },\n                                                    \"type\": \"condition\"\n                                                }\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"debug_id\": \"dce918ff-78d8-4e62-aaa4-82e70c031c43\",\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Sorry`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`bye`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Blocked`\"\n                                                    }\n                                                },\n                                                \"clear_session\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"transfer2\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Risk and other condition checks\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Transfer request\"\n                        },\n                        {\n                            \"policy_id\": \"PreApprove\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"id1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"FP\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"id2\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Message before approval\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"push preapprove\"\n                        },\n                        {\n                            \"policy_id\": \"MobileAuth_approval\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"List of auth choices\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pin_centralized\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"voice_server\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": true,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"auth choices\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test2\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Is transaction\",\n                                                \"type\": \"generic_request\",\n                                                \"siblingId\": 5892\n                                            },\n                                            \"field\": {\n                                                \"type\": \"request\",\n                                                \"value\": \"$.approval.source\"\n                                            },\n                                            \"data_type\": \"string\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \"contains\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": \"Transaction\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Biometric\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"alt label\",\n                                                        \"type\": \"information\"\n                                                    },\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`success`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Continue`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Title - information`\"\n                                                    },\n                                                    \"type\": \"information\",\n                                                    \"parameters\": []\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"mar1v1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"FP Auth from push notification\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Biometric\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"sso_level\": \"application\",\n                                            \"min_auth_level\": 4,\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"type\": \"sso_window\"\n                                            },\n                                            \"type\": \"sso_window\",\n                                            \"window_in_seconds\": 60\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"id2\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"biometric\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"pass\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Pass through approval- just click\"\n                                }\n                            ],\n                            \"type\": \"approval\",\n                            \"desc\": \"Web to mobile approval\"\n                        },\n                        {\n                            \"policy_id\": \"default_bind\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"Default Version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"json_data\"\n                                            },\n                                            \"data\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"{\\\"boo\\\":\\\"data\\\"}\"\n                                            },\n                                            \"type\": \"json_data\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"PW first\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"otp\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"channels\": [\n                                                                    {\n                                                                        \"from\": \"YourBank\",\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Please use this code with your new device: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"sms\",\n                                                                        \"target\": {\n                                                                            \"type\": \"user\",\n                                                                            \"value\": \"$.mobile\"\n                                                                        }\n                                                                    },\n                                                                    {\n                                                                        \"subject\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`New device registration`\"\n                                                                        },\n                                                                        \"text\": {\n                                                                            \"type\": \"expression\",\n                                                                            \"value\": \"`Please use this code with your new device: %otp%`\"\n                                                                        },\n                                                                        \"type\": \"email\",\n                                                                        \"target\": {\n                                                                            \"type\": \"user\",\n                                                                            \"value\": \"$.email\"\n                                                                        }\n                                                                    }\n                                                                ],\n                                                                \"failures_strategy\": {\n                                                                    \"type\": \"wrong_inputs_only\"\n                                                                },\n                                                                \"auto_execute\": false,\n                                                                \"otp_provider_id\": \"otp-internal-hotp\",\n                                                                \"otp_provider_config\": {\n                                                                    \"length\": 6\n                                                                },\n                                                                \"type\": \"otp\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"default\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"information\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Thank you for confirming this new device.  Please register your fingerprint for future authentications`\"\n                                                        },\n                                                        \"button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Continue`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Information`\"\n                                                        },\n                                                        \"type\": \"information\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Register touch/face\",\n                                                                \"type\": \"registration\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"silent\": true,\n                                                                    \"method\": \"face_id\"\n                                                                },\n                                                                {\n                                                                    \"silent\": false,\n                                                                    \"method\": \"fingerprint\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"registration\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"id1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"PW then drive OTP\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"PW\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"add_device_group\"\n                                                },\n                                                \"type\": \"add_device_group\",\n                                                \"group\": \"5adae172-5f2a-418b-9a73-76ed8f707c89\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"information\"\n                                                    },\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Done!`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Continue`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Information`\"\n                                                    },\n                                                    \"type\": \"information\",\n                                                    \"parameters\": []\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"bindbasic\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"PW only\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"newnew\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"variables\": [\n                                                {\n                                                    \"name\": \"isEligible\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"false\"\n                                                    }\n                                                }\n                                            ],\n                                            \"metadata\": {\n                                                \"declaredVarTypes\": [\n                                                    {\n                                                        \"type_descriptor\": {\n                                                            \"type\": \"any\"\n                                                        },\n                                                        \"name\": \"isEligible\"\n                                                    }\n                                                ],\n                                                \"type\": \"set_variables\"\n                                            },\n                                            \"type\": \"set_variables\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"false_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"condition\": {\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"generic_condition\"\n                                                },\n                                                \"field\": {\n                                                    \"type\": \"variable\",\n                                                    \"value\": \"isEligible\"\n                                                },\n                                                \"data_type\": \"boolean\",\n                                                \"type\": \"generic\",\n                                                \"operation\": \"==\",\n                                                \"value\": {\n                                                    \"type\": \"static\",\n                                                    \"value\": true\n                                                }\n                                            },\n                                            \"true_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"json_data\"\n                                                    },\n                                                    \"data\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"{\\\"true\\\":\\\"true\\\"}\"\n                                                    },\n                                                    \"type\": \"json_data\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"type\": \"condition\"\n                                        }\n                                    },\n                                    \"version_id\": \"rej\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"reject\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"passthru\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Passthru\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"PW first\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"cancel_button_text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Exit`\"\n                                                },\n                                                \"metadata\": {\n                                                    \"declaredVarTypes\": [\n                                                        {\n                                                            \"type_descriptor\": {\n                                                                \"schema\": {\n                                                                    \"properties\": {\n                                                                        \"user_input\": {\n                                                                            \"type\": \"string\"\n                                                                        }\n                                                                    }\n                                                                },\n                                                                \"type\": \"object\"\n                                                            },\n                                                            \"name\": \"persist\"\n                                                        }\n                                                    ],\n                                                    \"label\": \"Ask remember\",\n                                                    \"type\": \"confirmation\"\n                                                },\n                                                \"continue_button_text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Confirm`\"\n                                                },\n                                                \"text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`We will remember this device`\"\n                                                },\n                                                \"title\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Confirm`\"\n                                                },\n                                                \"strategy\": {\n                                                    \"variable_name\": \"persist\",\n                                                    \"type\": \"continue\"\n                                                },\n                                                \"type\": \"confirmation\",\n                                                \"parameters\": []\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"json_data\"\n                                                    },\n                                                    \"data\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"{\\\"persist\\\":persist}\"\n                                                    },\n                                                    \"type\": \"json_data\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"variables\": [\n                                                            {\n                                                                \"name\": \"test\",\n                                                                \"value\": {\n                                                                    \"type\": \"static\",\n                                                                    \"value\": \"\\\"boswell\\\"\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"metadata\": {\n                                                            \"declaredVarTypes\": [\n                                                                {\n                                                                    \"type_descriptor\": {\n                                                                        \"type\": \"any\"\n                                                                    },\n                                                                    \"name\": \"test\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"set_variables\"\n                                                        },\n                                                        \"type\": \"set_variables\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"false_branch\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"provision_totp\"\n                                                                },\n                                                                \"config_id\": \"default\",\n                                                                \"type\": \"provision_totp\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        },\n                                                        \"condition\": {\n                                                            \"negated\": false,\n                                                            \"metadata\": {\n                                                                \"type\": \"generic_condition\"\n                                                            },\n                                                            \"field\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"persist==\\\"Yes\\\"\"\n                                                            },\n                                                            \"data_type\": \"boolean\",\n                                                            \"type\": \"generic\",\n                                                            \"operation\": \"==\",\n                                                            \"value\": {\n                                                                \"type\": \"static\",\n                                                                \"value\": true\n                                                            }\n                                                        },\n                                                        \"true_branch\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"Remember group\",\n                                                                    \"type\": \"add_device_group\"\n                                                                },\n                                                                \"type\": \"add_device_group\",\n                                                                \"group\": \"5adae172-5f2a-418b-9a73-76ed8f707c89\"\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"metadata\": {\n                                                                        \"type\": \"registration\"\n                                                                    },\n                                                                    \"methods\": [\n                                                                        {\n                                                                            \"silent\": false,\n                                                                            \"method\": \"fingerprint\"\n                                                                        }\n                                                                    ],\n                                                                    \"type\": \"registration\"\n                                                                },\n                                                                \"type\": \"action\",\n                                                                \"child\": {\n                                                                    \"action\": {\n                                                                        \"metadata\": {\n                                                                            \"type\": \"provision_totp\"\n                                                                        },\n                                                                        \"config_id\": \"default\",\n                                                                        \"type\": \"provision_totp\"\n                                                                    },\n                                                                    \"type\": \"action\",\n                                                                    \"child\": {\n                                                                        \"action\": {\n                                                                            \"type\": \"auth_pass\"\n                                                                        },\n                                                                        \"type\": \"action\"\n                                                                    }\n                                                                }\n                                                            }\n                                                        },\n                                                        \"type\": \"condition\"\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"jul23\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"ask remember and TOTP\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"newnew\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"PIN or PW\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pin_centralized\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Temp access code\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"channels\": [],\n                                                            \"failures_strategy\": {\n                                                                \"type\": \"wrong_inputs_only\"\n                                                            },\n                                                            \"otp_provider_id\": \"otp-temporary-access-code\",\n                                                            \"type\": \"otp\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"tempcode1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"PIN and temp code\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurttest\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"wf1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"unreg device ph\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"t2\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"config_id\": \"default\",\n                                            \"type\": \"provision_totp\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"sil3\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Silent and totp\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"PIN or PW\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pin_centralized\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"notes\": \"Provision TOTP\",\n                                                    \"type\": \"provision_totp\"\n                                                },\n                                                \"config_id\": \"default\",\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"notes\": \"Register PIN\",\n                                                        \"type\": \"information\"\n                                                    },\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Please register a new PIN`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`OK`\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Information`\"\n                                                    },\n                                                    \"type\": \"information\",\n                                                    \"parameters\": []\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"registration\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": \"pin\"\n                                                            }\n                                                        ],\n                                                        \"type\": \"registration\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"cancel_button_text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`No thanks`\"\n                                                            },\n                                                            \"metadata\": {\n                                                                \"type\": \"confirmation\"\n                                                            },\n                                                            \"continue_button_text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Yes please`\"\n                                                            },\n                                                            \"text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Would you like to enroll for the face authenticator?`\"\n                                                            },\n                                                            \"title\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Confirm`\"\n                                                            },\n                                                            \"strategy\": {\n                                                                \"variable_name\": \"response\",\n                                                                \"type\": \"continue\"\n                                                            },\n                                                            \"type\": \"confirmation\",\n                                                            \"parameters\": []\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"false_branch\": {\n                                                                \"action\": {\n                                                                    \"metadata\": {\n                                                                        \"type\": \"redirect_to_journey\"\n                                                                    },\n                                                                    \"policy_id\": \"Login\",\n                                                                    \"params\": [],\n                                                                    \"type\": \"redirect\",\n                                                                    \"redirect_type\": \"invoke\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            },\n                                                            \"condition\": {\n                                                                \"negated\": false,\n                                                                \"metadata\": {\n                                                                    \"label\": \"Check if reg face\",\n                                                                    \"type\": \"generic_condition\"\n                                                                },\n                                                                \"field\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"response.user_input == \\\"ok\\\"\"\n                                                                },\n                                                                \"data_type\": \"boolean\",\n                                                                \"type\": \"generic\",\n                                                                \"operation\": \"==\",\n                                                                \"value\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"true\"\n                                                                }\n                                                            },\n                                                            \"true_branch\": {\n                                                                \"action\": {\n                                                                    \"metadata\": {\n                                                                        \"type\": \"registration\"\n                                                                    },\n                                                                    \"methods\": [\n                                                                        {\n                                                                            \"method\": \"face_server\"\n                                                                        }\n                                                                    ],\n                                                                    \"type\": \"registration\"\n                                                                },\n                                                                \"type\": \"action\",\n                                                                \"child\": {\n                                                                    \"action\": {\n                                                                        \"metadata\": {\n                                                                            \"type\": \"auth_pass\"\n                                                                        },\n                                                                        \"type\": \"auth_pass\"\n                                                                    },\n                                                                    \"type\": \"action\"\n                                                                }\n                                                            },\n                                                            \"type\": \"condition\"\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"qr1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"PW and QR to email on file\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"config_id\": \"windows\",\n                                            \"type\": \"provision_totp\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_bind_version_11\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"windows totp provision\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"debug_id\": \"6970a4c3-f687-4764-97e4-93d82968f9de\",\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"config_id\": \"default\",\n                                            \"type\": \"provision_totp\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"debug_id\": \"0ad80a2c-418a-4cbd-a6c3-35460c90fd53\",\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"json_data\"\n                                                },\n                                                \"data\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"{\\n  \\\"commands\\\": [\\n    {\\n      \\\"command\\\": \\\"provision\\\",\\n      \\\"user_association\\\": {\\n        \\\"display_user_name\\\": @policy.user().id,\\n        \\\"branding\\\": {\\n          \\\"organization_name\\\": \\\"Transmit Bank\\\",\\n          \\\"organization_logo\\\": \\\"\\\"\\n        },\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"user_login\\\",\\n            \\\"policy_id\\\": \\\"Login\\\",\\n            \\\"invoke_type\\\": \\\"authenticate\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"account_status\\\",\\n            \\\"policy_id\\\": \\\"Account\\\",\\n            \\\"invoke_type\\\": \\\"authenticate\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"my_activity\\\",\\n            \\\"policy_id\\\": \\\"MyActivity\\\",\\n            \\\"invoke_type\\\": \\\"authenticate\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"contact_support\\\",\\n            \\\"policy_id\\\": \\\"ContactSupport\\\",\\n            \\\"invoke_type\\\": \\\"authenticate\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"soft_token\\\",\\n            \\\"generator_name\\\": \\\"default\\\",\\n            \\\"invoke_type\\\": \\\"totp\\\",\\n            \\\"execution_type\\\": \\\"regular\\\"\\n          }\\n        ],\\n        \\\"custom_actions\\\": [\\n          {\\n            \\\"group_id\\\": \\\"banking\\\",\\n            \\\"label\\\": \\\"Banking\\\",\\n            \\\"actions\\\": [\\n              {\\n                \\\"policy_id\\\": \\\"qr\\\",\\n                \\\"label\\\": \\\"Scan QR from Browser\\\",\\n                \\\"invoke_type\\\": \\\"invoke\\\"\\n              },\\n              {\\n                \\\"policy_id\\\": \\\"settings\\\",\\n                \\\"label\\\": \\\"Transfer Preferences\\\",\\n                \\\"invoke_type\\\": \\\"invoke\\\"\\n              },\\n              {\\n                \\\"policy_id\\\": \\\"add_payee\\\",\\n                \\\"label\\\": \\\"Add Payee\\\",\\n                \\\"invoke_type\\\": \\\"invoke\\\"\\n              },\\n              {\\n                \\\"policy_id\\\": \\\"Transfer\\\",\\n                \\\"label\\\": \\\"Transfer Money\\\",\\n                \\\"invoke_type\\\": \\\"invoke\\\"\\n              },\\n              {\\n                \\\"policy_id\\\": \\\"kyc\\\",\\n                \\\"label\\\": \\\"Document Verify\\\",\\n                \\\"invoke_type\\\": \\\"invoke\\\"\\n              }\\n            ]\\n          }\\n        ]\\n      }\\n    }\\n  ]\\n}\"\n                                                },\n                                                \"type\": \"json_data\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"debug_id\": \"f3cd861f-4426-456a-bffb-e100fd5b83ad\",\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"tsxdemo1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Provision TSXDemo app\"\n                                }\n                            ],\n                            \"type\": \"bind\",\n                            \"desc\": \"Default Bind Policy\"\n                        },\n                        {\n                            \"policy_id\": \"Balance\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"cor\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"information\"\n                                            },\n                                            \"text\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"`Please step up auth for viewing balance`\"\n                                            },\n                                            \"button_text\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"`Continue`\"\n                                            },\n                                            \"title\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"`Information`\"\n                                            },\n                                            \"type\": \"information\",\n                                            \"parameters\": []\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"id2\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"step up\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"variables\": [\n                                                {\n                                                    \"name\": \"qod\",\n                                                    \"value\": {\n                                                        \"ns\": \"webrequests\",\n                                                        \"function\": \"WebReq-Quote\",\n                                                        \"argExpressions\": [\n                                                            {\n                                                                \"type\": \"static\",\n                                                                \"value\": \"null\"\n                                                            }\n                                                        ],\n                                                        \"type\": \"fnInvoke\"\n                                                    }\n                                                }\n                                            ],\n                                            \"metadata\": {\n                                                \"declaredVarTypes\": [\n                                                    {\n                                                        \"type_descriptor\": {\n                                                            \"schema\": {\n                                                                \"type\": \"object\",\n                                                                \"properties\": {\n                                                                    \"headers\": {\n                                                                        \"description\": \"A map mapping header names to values\",\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"body\": {\n                                                                        \"description\": \"JSON value returned from web service\",\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"status\": {\n                                                                        \"description\": \"HTTP code returned from the web service\",\n                                                                        \"type\": \"integer\"\n                                                                    }\n                                                                }\n                                                            },\n                                                            \"type\": \"object\"\n                                                        },\n                                                        \"name\": \"qod\"\n                                                    }\n                                                ],\n                                                \"label\": \"Get quote of the day\",\n                                                \"type\": \"web_request\"\n                                            },\n                                            \"type\": \"set_variables\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Pop info message with quote of the day\",\n                                                    \"type\": \"information\"\n                                                },\n                                                \"text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`${qod.body}`\"\n                                                },\n                                                \"button_text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"Continue\"\n                                                },\n                                                \"title\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"Information\"\n                                                },\n                                                \"type\": \"information\",\n                                                \"parameters\": []\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"id3\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"QoD message\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"metadata\": {\n                                            \"node_type\": \"generic\",\n                                            \"type\": \"generic_condition\"\n                                        },\n                                        \"field\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"@policy.user().id\"\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"cancel_button_text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Negative`\"\n                                                },\n                                                \"metadata\": {\n                                                    \"declaredVarTypes\": [\n                                                        {\n                                                            \"type_descriptor\": {\n                                                                \"schema\": {\n                                                                    \"properties\": {\n                                                                        \"user_input\": {\n                                                                            \"type\": \"string\"\n                                                                        }\n                                                                    }\n                                                                },\n                                                                \"type\": \"object\"\n                                                            },\n                                                            \"name\": \"response\"\n                                                        }\n                                                    ],\n                                                    \"label\": \"EN confirm\",\n                                                    \"type\": \"confirmation\"\n                                                },\n                                                \"continue_button_text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Happy path`\"\n                                                },\n                                                \"text\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Custom text`\"\n                                                },\n                                                \"title\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`My custom title`\"\n                                                },\n                                                \"strategy\": {\n                                                    \"variable_name\": \"response\",\n                                                    \"type\": \"continue\"\n                                                },\n                                                \"type\": \"confirmation\",\n                                                \"parameters\": []\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"matched_branches\": [\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"generic_condition\"\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"kurt\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                },\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"cancel_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Not now`\"\n                                                        },\n                                                        \"metadata\": {\n                                                            \"declaredVarTypes\": [\n                                                                {\n                                                                    \"type_descriptor\": {\n                                                                        \"schema\": {\n                                                                            \"properties\": {\n                                                                                \"user_input\": {\n                                                                                    \"type\": \"string\"\n                                                                                }\n                                                                            }\n                                                                        },\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"name\": \"response\"\n                                                                }\n                                                            ],\n                                                            \"label\": \"EN confirm\",\n                                                            \"type\": \"confirmation\"\n                                                        },\n                                                        \"continue_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Yes please`\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Register for Voice Authentication`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`My custom title`\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"variable_name\": \"response\",\n                                                            \"type\": \"continue\"\n                                                        },\n                                                        \"type\": \"confirmation\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Reg voice\",\n                                                                \"type\": \"registration\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"silent\": false,\n                                                                    \"method\": \"voice_server\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"registration\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"EN info\",\n                                                                    \"type\": \"information\"\n                                                                },\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`You are now registered for voice, thank you`\"\n                                                                },\n                                                                \"button_text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Continue`\"\n                                                                },\n                                                                \"title\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Information`\"\n                                                                },\n                                                                \"type\": \"information\",\n                                                                \"parameters\": []\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"metadata\": {\n                                                                        \"type\": \"auth_pass\"\n                                                                    },\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            },\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"generic_condition\"\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"test\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                },\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"cancel_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Nunca`\"\n                                                        },\n                                                        \"metadata\": {\n                                                            \"declaredVarTypes\": [\n                                                                {\n                                                                    \"type_descriptor\": {\n                                                                        \"schema\": {\n                                                                            \"properties\": {\n                                                                                \"user_input\": {\n                                                                                    \"type\": \"string\"\n                                                                                }\n                                                                            }\n                                                                        },\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"name\": \"response\"\n                                                                }\n                                                            ],\n                                                            \"label\": \"ES confirm\",\n                                                            \"type\": \"confirmation\"\n                                                        },\n                                                        \"continue_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`S por favor`\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Registrar autenticacin de voz?`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Mi ttulo personalizado`\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"variable_name\": \"response\",\n                                                            \"type\": \"continue\"\n                                                        },\n                                                        \"type\": \"confirmation\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"ES Info\",\n                                                                \"type\": \"information\"\n                                                            },\n                                                            \"text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`\\nAhora ests registrado para la autenticacin de voz, gracias`\"\n                                                            },\n                                                            \"button_text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Continuar`\"\n                                                            },\n                                                            \"title\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Informacin`\"\n                                                            },\n                                                            \"type\": \"information\",\n                                                            \"parameters\": []\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        ],\n                                        \"type\": \"match_case\"\n                                    },\n                                    \"version_id\": \"conf1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Confirmation\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Balance inquiry\"\n                        },\n                        {\n                            \"policy_id\": \"MobileQR\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"qr auth\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"channels\": [\n                                                            {\n                                                                \"subject\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Scan to auth`\"\n                                                                },\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Please scan with mobile:`\"\n                                                                },\n                                                                \"type\": \"email\",\n                                                                \"target\": {\n                                                                    \"type\": \"user\",\n                                                                    \"value\": \"$.mobile\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"failures_strategy\": {\n                                                            \"type\": \"wrong_inputs_only\"\n                                                        },\n                                                        \"otp_provider_id\": \"qr\",\n                                                        \"type\": \"otp\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"Default Version\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Default Auth\"\n                        },\n                        {\n                            \"policy_id\": \"ProvisionTOTP\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pin_centralized\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pattern_centralized\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"voice_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_id\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": true,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"provision_totp\"\n                                                },\n                                                \"config_id\": \"default\",\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default version\"\n                                }\n                            ],\n                            \"type\": \"approval\",\n                            \"desc\": \"Flow to provision TOTP if requested from web\"\n                        },\n                        {\n                            \"policy_id\": \"RegisterVoice\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"registration\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"silent\": false,\n                                                    \"method\": \"voice_server\"\n                                                }\n                                            ],\n                                            \"type\": \"registration\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"reg1\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Register\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"registration\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"silent\": false,\n                                                    \"method\": \"fingerprint\"\n                                                }\n                                            ],\n                                            \"type\": \"registration\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"reg2\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"fp\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": true,\n                                \"session_create\": false,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Register VoicePrint\"\n                        },\n                        {\n                            \"policy_id\": \"default_unregistration\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"auth pass\"\n                                }\n                            ],\n                            \"type\": \"unreg\",\n                            \"desc\": \"Before unregistering existing authenticator\"\n                        },\n                        {\n                            \"policy_id\": \"provision\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"static\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"config_id\": \"default\",\n                                            \"type\": \"provision_totp\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"default version\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"TOTP provision\"\n                        },\n                        {\n                            \"policy_id\": \"transaction_confirmation\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\",\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"secondary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"voice_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pattern_centralized\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": false,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"time_window\": 300,\n                                                \"type\": \"secondary_new_method\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"dkurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"false_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Finger\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"default\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"condition\": {\n                                                \"sso_level\": \"application\",\n                                                \"min_auth_level\": 2,\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"sso_window\",\n                                                    \"siblingId\": 906\n                                                },\n                                                \"type\": \"sso_window\",\n                                                \"window_in_seconds\": 300\n                                            },\n                                            \"true_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Check amount\",\n                                                \"type\": \"generic_request\",\n                                                \"siblingId\": 2440\n                                            },\n                                            \"field\": {\n                                                \"type\": \"request\",\n                                                \"value\": \"$.params.amount\"\n                                            },\n                                            \"data_type\": \"integer\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \">=\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": \"1000\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Step up auth with security level 5 or higher\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"default\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"otherwise_branch\": {\n                                            \"action\": {\n                                                \"dialog\": {\n                                                    \"text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Sorry`\"\n                                                    },\n                                                    \"button_text\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"``\"\n                                                    },\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Blocked`\"\n                                                    }\n                                                },\n                                                \"clear_session\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"reject\"\n                                                },\n                                                \"type\": \"reject\"\n                                            },\n                                            \"type\": \"action\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"transfer1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Transfer with conditional auth\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"cor\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"idd2\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"auth pass\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Transaction\"\n                        },\n                        {\n                            \"policy_id\": \"extend\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"metadata\": {\n                                            \"type\": \"procedure\"\n                                        },\n                                        \"procedure_id\": \"8680a054-c316-4ed8-954f-dbb31adcbaec\",\n                                        \"type\": \"procedure\",\n                                        \"child\": {\n                                            \"type\": \"empty\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"test\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"test\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": false,\n                                \"session_validate\": true,\n                                \"session_create\": false,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Extend session\"\n                        },\n                        {\n                            \"policy_id\": \"StepUp\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": []\n                                    },\n                                    \"workflow\": {\n                                        \"field\": {\n                                            \"type\": \"request\",\n                                            \"value\": \"$.params.chosenauth\"\n                                        },\n                                        \"matched_branches\": [\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"generic_request\"\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"fp\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                },\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"label\": \"fp only\",\n                                                            \"type\": \"primary_authentication_menu\"\n                                                        },\n                                                        \"methods\": [\n                                                            {\n                                                                \"method\": {\n                                                                    \"type\": \"fingerprint\"\n                                                                }\n                                                            }\n                                                        ],\n                                                        \"options\": {\n                                                            \"update_default\": false,\n                                                            \"start_with\": \"first\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"type\": \"primary\"\n                                                        },\n                                                        \"type\": \"authentication\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"action\"\n                                                    }\n                                                }\n                                            },\n                                            {\n                                                \"matcher\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"generic_request\"\n                                                    },\n                                                    \"data_type\": \"string\",\n                                                    \"type\": \"generic_operation\",\n                                                    \"value\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"otp\"\n                                                    },\n                                                    \"operation\": \"==\"\n                                                }\n                                            }\n                                        ],\n                                        \"type\": \"match_case\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default version\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Step up for rewards, address, transfer actions\"\n                        },\n                        {\n                            \"policy_id\": \"lookup\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"all relevant auth options\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"password\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pattern_centralized\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_id\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"pin_centralized\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"voice_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"default version\"\n                                }\n                            ],\n                            \"type\": \"anonymous\",\n                            \"desc\": \"Lookup id\"\n                        },\n                        {\n                            \"policy_id\": \"unreg\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"unregistration\"\n                                            },\n                                            \"method\": \"placeholder_ep\",\n                                            \"type\": \"unregistration\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"procedure_id\": \"8680a054-c316-4ed8-954f-dbb31adcbaec\",\n                                            \"type\": \"procedure\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurttest\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"unregistration\"\n                                            },\n                                            \"method\": \"fingerprint\",\n                                            \"type\": \"unregistration\",\n                                            \"device_selection_strategy\": {\n                                                \"device_id\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"@policy.request().params.specificDeviceID\"\n                                                },\n                                                \"type\": \"specific\"\n                                            }\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"un1\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"unreg1\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Auth with list of authenticators\",\n                                                    \"type\": \"primary_authentication_menu\"\n                                                },\n                                                \"methods\": [\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"fingerprint\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"password\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pattern_centralized\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"pin_centralized\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"voice_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_server\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"method\": {\n                                                            \"type\": \"face_id\"\n                                                        }\n                                                    }\n                                                ],\n                                                \"options\": {\n                                                    \"start_in_menu\": true,\n                                                    \"update_default\": true,\n                                                    \"start_with\": \"menu\"\n                                                },\n                                                \"strategy\": {\n                                                    \"type\": \"primary\"\n                                                },\n                                                \"type\": \"authentication\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Is fingerprint/TouchID supported?\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"!@policy.request().collection_result.content.capabilities.finger_print_supported \\t\"\n                                            },\n                                            \"data_type\": \"boolean\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \"==\",\n                                            \"value\": {\n                                                \"type\": \"static\",\n                                                \"value\": true\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"false_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"Auth with list of authenticators\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"fingerprint\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pattern_centralized\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"pin_centralized\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"voice_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_server\"\n                                                            }\n                                                        },\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"face_id\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"start_in_menu\": true,\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"menu\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            },\n                                            \"condition\": {\n                                                \"negated\": false,\n                                                \"metadata\": {\n                                                    \"type\": \"authenticator_status\",\n                                                    \"siblingId\": 543\n                                                },\n                                                \"method\": [\n                                                    \"fingerprint\"\n                                                ],\n                                                \"and\": false,\n                                                \"type\": \"authenticator_status\",\n                                                \"status\": \"unregistered\"\n                                            },\n                                            \"true_branch\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"label\": \"auth with PW\",\n                                                        \"type\": \"primary_authentication_menu\"\n                                                    },\n                                                    \"methods\": [\n                                                        {\n                                                            \"method\": {\n                                                                \"type\": \"password\"\n                                                            }\n                                                        }\n                                                    ],\n                                                    \"options\": {\n                                                        \"update_default\": true,\n                                                        \"start_with\": \"first\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"type\": \"primary\"\n                                                    },\n                                                    \"type\": \"authentication\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"cancel_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`No thanks`\"\n                                                        },\n                                                        \"metadata\": {\n                                                            \"declaredVarTypes\": [\n                                                                {\n                                                                    \"type_descriptor\": {\n                                                                        \"schema\": {\n                                                                            \"properties\": {\n                                                                                \"user_input\": {\n                                                                                    \"type\": \"string\"\n                                                                                }\n                                                                            }\n                                                                        },\n                                                                        \"type\": \"object\"\n                                                                    },\n                                                                    \"name\": \"enroll\"\n                                                                }\n                                                            ],\n                                                            \"label\": \"Ask user to enroll FP yes/no\",\n                                                            \"type\": \"confirmation\"\n                                                        },\n                                                        \"continue_button_text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Sign me up!`\"\n                                                        },\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please enroll your fingerprint so you don't need your password anymore`\"\n                                                        },\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Confirm`\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"variable_name\": \"enroll\",\n                                                            \"type\": \"continue\"\n                                                        },\n                                                        \"type\": \"confirmation\",\n                                                        \"parameters\": []\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"label\": \"Enroll FP\",\n                                                                \"type\": \"registration\"\n                                                            },\n                                                            \"methods\": [\n                                                                {\n                                                                    \"silent\": false,\n                                                                    \"method\": \"fingerprint\"\n                                                                }\n                                                            ],\n                                                            \"type\": \"registration\"\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"label\": \"Success message\",\n                                                                    \"type\": \"information\"\n                                                                },\n                                                                \"text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Congratulations, you can now login with your fingerprint`\"\n                                                                },\n                                                                \"button_text\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Continue`\"\n                                                                },\n                                                                \"title\": {\n                                                                    \"type\": \"expression\",\n                                                                    \"value\": \"`Success`\"\n                                                                },\n                                                                \"type\": \"information\",\n                                                                \"parameters\": []\n                                                            },\n                                                            \"type\": \"action\",\n                                                            \"child\": {\n                                                                \"action\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"action\"\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            },\n                                            \"type\": \"condition\"\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"jun22\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"Drive FP enroll\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Unregister stuff\"\n                        },\n                        {\n                            \"policy_id\": \"scan\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"metadata\": {\n                                            \"type\": \"procedure\"\n                                        },\n                                        \"procedure_id\": \"24fdeee6-b79a-4fab-8342-0ba323746608\",\n                                        \"type\": \"procedure\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\",\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"Bio auth first\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"voice_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_id\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"start_in_menu\": true,\n                                                \"update_default\": true,\n                                                \"start_with\": \"menu\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"instructions\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Scan the QR on web`\"\n                                                },\n                                                \"metadata\": {\n                                                    \"declaredVarTypes\": [\n                                                        {\n                                                            \"type_descriptor\": {\n                                                                \"schema\": {\n                                                                    \"properties\": {\n                                                                        \"qr_content\": {\n                                                                            \"type\": \"string\"\n                                                                        }\n                                                                    }\n                                                                },\n                                                                \"type\": \"object\"\n                                                            },\n                                                            \"name\": \"ticketId\"\n                                                        }\n                                                    ],\n                                                    \"label\": \"Scan QR and place content in variable\",\n                                                    \"type\": \"scan_qr\"\n                                                },\n                                                \"output_variable\": \"ticketId\",\n                                                \"type\": \"scan_qr\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"declaredVarTypes\": [\n                                                            {\n                                                                \"type_descriptor\": {\n                                                                    \"schema\": {\n                                                                        \"properties\": {\n                                                                            \"system_params\": {\n                                                                                \"type\": \"object\",\n                                                                                \"properties\": {\n                                                                                    \"issuing_app\": {\n                                                                                        \"type\": \"string\"\n                                                                                    },\n                                                                                    \"issuing_policy\": {\n                                                                                        \"type\": \"string\"\n                                                                                    }\n                                                                                }\n                                                                            },\n                                                                            \"user_params\": {\n                                                                                \"type\": \"object\"\n                                                                            }\n                                                                        }\n                                                                    },\n                                                                    \"type\": \"object\"\n                                                                },\n                                                                \"name\": \"ticketInfo\"\n                                                            }\n                                                        ],\n                                                        \"label\": \"Consume ticket and return user ID\",\n                                                        \"type\": \"consume_ticket\"\n                                                    },\n                                                    \"output_variable\": \"ticketInfo\",\n                                                    \"ticket_id\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"ticketId.qr_content\"\n                                                    },\n                                                    \"type\": \"consume_ticket\",\n                                                    \"reply_parameters\": [\n                                                        {\n                                                            \"name\": \"user\",\n                                                            \"value\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"@policy.user().id\"\n                                                            }\n                                                        }\n                                                    ]\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"sc1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Scan QR\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": false,\n                                \"session_validate\": true,\n                                \"session_create\": false,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Scan QR for  userless web login\"\n                        },\n                        {\n                            \"policy_id\": \"qr\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"metadata\": {\n                                            \"type\": \"procedure\"\n                                        },\n                                        \"procedure_id\": \"24fdeee6-b79a-4fab-8342-0ba323746608\",\n                                        \"type\": \"procedure\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"action\"\n                                        }\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"users\",\n                                        \"value\": [\n                                            \"kurt\",\n                                            \"test\"\n                                        ]\n                                    },\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"label\": \"Bio auth first\",\n                                                \"type\": \"primary_authentication_menu\"\n                                            },\n                                            \"methods\": [\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"fingerprint\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"voice_server\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_id\"\n                                                    }\n                                                },\n                                                {\n                                                    \"method\": {\n                                                        \"type\": \"face_server\"\n                                                    }\n                                                }\n                                            ],\n                                            \"options\": {\n                                                \"update_default\": true,\n                                                \"start_with\": \"default\"\n                                            },\n                                            \"strategy\": {\n                                                \"type\": \"primary\"\n                                            },\n                                            \"type\": \"authentication\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"instructions\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Scan the QR on web`\"\n                                                },\n                                                \"metadata\": {\n                                                    \"declaredVarTypes\": [\n                                                        {\n                                                            \"type_descriptor\": {\n                                                                \"schema\": {\n                                                                    \"properties\": {\n                                                                        \"qr_content\": {\n                                                                            \"type\": \"string\"\n                                                                        }\n                                                                    }\n                                                                },\n                                                                \"type\": \"object\"\n                                                            },\n                                                            \"name\": \"ticketId\"\n                                                        }\n                                                    ],\n                                                    \"label\": \"Scan QR and place content in variable\",\n                                                    \"type\": \"scan_qr\"\n                                                },\n                                                \"output_variable\": \"ticketId\",\n                                                \"type\": \"scan_qr\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"declaredVarTypes\": [\n                                                            {\n                                                                \"type_descriptor\": {\n                                                                    \"schema\": {\n                                                                        \"properties\": {\n                                                                            \"system_params\": {\n                                                                                \"type\": \"object\",\n                                                                                \"properties\": {\n                                                                                    \"issuing_app\": {\n                                                                                        \"type\": \"string\"\n                                                                                    },\n                                                                                    \"issuing_policy\": {\n                                                                                        \"type\": \"string\"\n                                                                                    }\n                                                                                }\n                                                                            },\n                                                                            \"user_params\": {\n                                                                                \"type\": \"object\"\n                                                                            }\n                                                                        }\n                                                                    },\n                                                                    \"type\": \"object\"\n                                                                },\n                                                                \"name\": \"ticketInfo\"\n                                                            }\n                                                        ],\n                                                        \"label\": \"Consume ticket and return user ID\",\n                                                        \"type\": \"consume_ticket\"\n                                                    },\n                                                    \"output_variable\": \"ticketInfo\",\n                                                    \"ticket_id\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"ticketId.qr_content\"\n                                                    },\n                                                    \"type\": \"consume_ticket\",\n                                                    \"reply_parameters\": [\n                                                        {\n                                                            \"name\": \"user\",\n                                                            \"value\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"@policy.user().id\"\n                                                            }\n                                                        }\n                                                    ]\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"auth_pass\"\n                                                        },\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"action\"\n                                                }\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"sc1\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"Scan QR\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": false,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"QR scan for userless from web\"\n                        },\n                        {\n                            \"policy_id\": \"regTotp\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default version\"\n                                },\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"config_id\": \"default\",\n                                            \"type\": \"provision_totp\"\n                                        },\n                                        \"type\": \"action\",\n                                        \"child\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"elad totp\",\n                                                    \"type\": \"provision_totp\"\n                                                },\n                                                \"config_id\": \"elad\",\n                                                \"type\": \"provision_totp\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        }\n                                    },\n                                    \"version_id\": \"totp1\",\n                                    \"state\": \"production\",\n                                    \"desc\": \"Reg TOTP\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"Provision TOTP\"\n                        },\n                        {\n                            \"policy_id\": \"QrBind\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"workflow\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"disabled\",\n                                    \"desc\": \"default_version\"\n                                }\n                            ],\n                            \"type\": \"anonymous\",\n                            \"desc\": \"Anonymous QR scan to bind\"\n                        },\n                        {\n                            \"policy_id\": \"kyc\",\n                            \"versions\": [\n                                {\n                                    \"schema_version\": 2,\n                                    \"filter_criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"true\"\n                                        }\n                                    },\n                                    \"workflow\": {\n                                        \"false_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"type\": \"form\"\n                                                },\n                                                \"form_id\": \"onfido\",\n                                                \"provider_data\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"{}\"\n                                                },\n                                                \"app_data\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"{\\n  \\\"sdk_token\\\":@webrequests.OnFidoCreateSDKToken(@policy.user().custom_data.applicant_id,\\\"com.transmitsecurity.field.TSXDemo\\\").body.token\\n    }\"\n                                                },\n                                                \"type\": \"form\",\n                                                \"form_provider\": \"6863e9e5-2666-4b49-8f11-4522f4ac30b0\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"auth_pass\"\n                                                    },\n                                                    \"type\": \"auth_pass\"\n                                                },\n                                                \"type\": \"action\"\n                                            }\n                                        },\n                                        \"condition\": {\n                                            \"negated\": false,\n                                            \"metadata\": {\n                                                \"label\": \"Registered with OnFido?\",\n                                                \"type\": \"generic_condition\"\n                                            },\n                                            \"field\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"!@policy.user().custom_data.applicant_id\"\n                                            },\n                                            \"data_type\": \"boolean\",\n                                            \"type\": \"generic\",\n                                            \"operation\": \"==\",\n                                            \"value\": {\n                                                \"type\": \"expression\",\n                                                \"value\": \"true\"\n                                            }\n                                        },\n                                        \"true_branch\": {\n                                            \"action\": {\n                                                \"metadata\": {\n                                                    \"label\": \"Register applicant\",\n                                                    \"type\": \"form\"\n                                                },\n                                                \"form_id\": \"capture_applicant_details\",\n                                                \"provider_data\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"{}\"\n                                                },\n                                                \"app_data\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"{\\n   type:\\\"dynamic_form\\\",\\n   title:\\\"KYC: User Information\\\",\\n   subtitle:\\\"Enter required fields for verificaiton\\\",\\n   actions:[\\n      {\\n         type:\\\"text\\\",\\n         id:\\\"first_name\\\",\\n         name:\\\"First Name\\\",\\n         mandatory:true,\\n         value:\\\"John\\\"\\n      },\\n      {\\n         type:\\\"text\\\",\\n         id:\\\"last_name\\\",\\n         name:\\\"Last Name\\\",\\n         mandatory:true,\\n         value:\\\"Doe\\\"\\n      },\\n      {\\n         type:\\\"text\\\",\\n         id:\\\"dob\\\",\\n         name:\\\"Date of Birth\\\",\\n         mandatory:true,\\n         value:\\\"1981-01-16\\\",\\n         hint: \\\"yyyy-mm-dd\\\"\\n      }\\n   ]\\n}\"\n                                                },\n                                                \"type\": \"form\",\n                                                \"form_provider\": \"b1371226-70f2-4899-bbff-7702dbbb6e54\",\n                                                \"var_name\": \"user_input\"\n                                            },\n                                            \"type\": \"action\",\n                                            \"child\": {\n                                                \"action\": {\n                                                    \"metadata\": {\n                                                        \"type\": \"custom_user_data\"\n                                                    },\n                                                    \"data\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"let applicant_id = @webrequests.OnFidoCreateApplicant(user_input.form_response.actions.first_name, user_input.form_response.actions.last_name, user_input.form_response.actions.dob).body.id\\nreturn {\\\"applicant_id\\\":applicant_id}\"\n                                                    },\n                                                    \"scope\": \"user\",\n                                                    \"type\": \"custom_data\"\n                                                },\n                                                \"type\": \"action\",\n                                                \"child\": {\n                                                    \"action\": {\n                                                        \"metadata\": {\n                                                            \"type\": \"form\"\n                                                        },\n                                                        \"form_id\": \"onfido\",\n                                                        \"provider_data\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"{}\"\n                                                        },\n                                                        \"app_data\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"{\\n  \\\"sdk_token\\\":@webrequests.OnFidoCreateSDKToken(@policy.user().custom_data.applicant_id,\\\"com.transmitsecurity.field.TSXDemo\\\").body.token\\n}\"\n                                                        },\n                                                        \"type\": \"form\",\n                                                        \"form_provider\": \"6863e9e5-2666-4b49-8f11-4522f4ac30b0\"\n                                                    },\n                                                    \"type\": \"action\",\n                                                    \"child\": {\n                                                        \"action\": {\n                                                            \"metadata\": {\n                                                                \"type\": \"information\"\n                                                            },\n                                                            \"text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Example information text.`\"\n                                                            },\n                                                            \"button_text\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`OK`\"\n                                                            },\n                                                            \"title\": {\n                                                                \"type\": \"expression\",\n                                                                \"value\": \"`Information`\"\n                                                            },\n                                                            \"type\": \"information\",\n                                                            \"parameters\": []\n                                                        },\n                                                        \"type\": \"action\",\n                                                        \"child\": {\n                                                            \"action\": {\n                                                                \"metadata\": {\n                                                                    \"type\": \"auth_pass\"\n                                                                },\n                                                                \"type\": \"auth_pass\"\n                                                            },\n                                                            \"type\": \"action\"\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        },\n                                        \"type\": \"condition\"\n                                    },\n                                    \"version_id\": \"default_version\",\n                                    \"state\": \"version\",\n                                    \"desc\": \"default_version\"\n                                }\n                            ],\n                            \"type\": \"auth\",\n                            \"config\": {\n                                \"token_create\": true,\n                                \"session_validate\": false,\n                                \"session_create\": true,\n                                \"token_include_request_params\": true\n                            },\n                            \"desc\": \"OnFido KYC\"\n                        }\n                    ],\n                    \"scorer_id\": \"5abc5166-1c18-4781-b228-3229ac46e6c2\",\n                    \"totp_configs\": [\n                        {\n                            \"integrity_protection_disabled\": false,\n                            \"allow_code_reuse\": false,\n                            \"protection_method\": \"user_decided\",\n                            \"length\": 6,\n                            \"id\": \"default\",\n                            \"type\": \"totp\",\n                            \"add_check_digit\": false,\n                            \"ttl\": 60\n                        },\n                        {\n                            \"integrity_protection_disabled\": false,\n                            \"allow_code_reuse\": false,\n                            \"protection_method\": \"user_decided\",\n                            \"length\": 6,\n                            \"id\": \"elad\",\n                            \"type\": \"totp\",\n                            \"add_check_digit\": false,\n                            \"ttl\": 60\n                        },\n                        {\n                            \"integrity_protection_disabled\": false,\n                            \"bound_uks_key\": \"pin_encryption\",\n                            \"protection_method\": \"user_decided\",\n                            \"length\": 10,\n                            \"id\": \"windows\",\n                            \"type\": \"ecotp\",\n                            \"add_check_digit\": false\n                        }\n                    ],\n                    \"type\": \"mobile\",\n                    \"version\": 764,\n                    \"procedures\": [\n                        {\n                            \"schema_version\": 2,\n                            \"workflow\": {\n                                \"action\": {\n                                    \"metadata\": {\n                                        \"type\": \"registration\"\n                                    },\n                                    \"methods\": [\n                                        {\n                                            \"method\": \"pin_centralized\"\n                                        }\n                                    ],\n                                    \"type\": \"registration\"\n                                },\n                                \"type\": \"action\",\n                                \"child\": {\n                                    \"action\": {\n                                        \"metadata\": {\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"auth_pass\"\n                                    },\n                                    \"type\": \"action\"\n                                }\n                            },\n                            \"name\": \"test\",\n                            \"id\": \"8680a054-c316-4ed8-954f-dbb31adcbaec\"\n                        },\n                        {\n                            \"schema_version\": 2,\n                            \"workflow\": {\n                                \"action\": {\n                                    \"type\": \"auth_pass\"\n                                },\n                                \"type\": \"action\"\n                            },\n                            \"name\": \"test2\",\n                            \"id\": \"fafcb96b-e3fc-4d0d-a1e1-4642c23c14d8\"\n                        },\n                        {\n                            \"schema_version\": 2,\n                            \"workflow\": {\n                                \"action\": {\n                                    \"instructions\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"`Scan userless login QR`\"\n                                    },\n                                    \"metadata\": {\n                                        \"declaredVarTypes\": [\n                                            {\n                                                \"type_descriptor\": {\n                                                    \"schema\": {\n                                                        \"properties\": {\n                                                            \"qr_content\": {\n                                                                \"type\": \"string\"\n                                                            }\n                                                        }\n                                                    },\n                                                    \"type\": \"object\"\n                                                },\n                                                \"name\": \"ticketId\"\n                                            }\n                                        ],\n                                        \"type\": \"scan_qr\"\n                                    },\n                                    \"output_variable\": \"ticketId\",\n                                    \"type\": \"scan_qr\"\n                                },\n                                \"type\": \"action\",\n                                \"child\": {\n                                    \"action\": {\n                                        \"metadata\": {\n                                            \"declaredVarTypes\": [\n                                                {\n                                                    \"type_descriptor\": {\n                                                        \"schema\": {\n                                                            \"properties\": {\n                                                                \"system_params\": {\n                                                                    \"type\": \"object\",\n                                                                    \"properties\": {\n                                                                        \"issuing_app\": {\n                                                                            \"type\": \"string\"\n                                                                        },\n                                                                        \"issuing_policy\": {\n                                                                            \"type\": \"string\"\n                                                                        }\n                                                                    }\n                                                                },\n                                                                \"user_params\": {\n                                                                    \"type\": \"object\"\n                                                                }\n                                                            }\n                                                        },\n                                                        \"type\": \"object\"\n                                                    },\n                                                    \"name\": \"ticketInfo\"\n                                                }\n                                            ],\n                                            \"label\": \"Process ticket, supply user ID\",\n                                            \"type\": \"consume_ticket\"\n                                        },\n                                        \"output_variable\": \"ticketInfo\",\n                                        \"ticket_id\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"ticketId\"\n                                        },\n                                        \"type\": \"consume_ticket\",\n                                        \"reply_parameters\": [\n                                            {\n                                                \"name\": \"user\",\n                                                \"value\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"@policy.user().id\"\n                                                }\n                                            }\n                                        ]\n                                    },\n                                    \"type\": \"action\",\n                                    \"child\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    }\n                                }\n                            },\n                            \"name\": \"scanQR\",\n                            \"id\": \"24fdeee6-b79a-4fab-8342-0ba323746608\"\n                        },\n                        {\n                            \"schema_version\": 2,\n                            \"workflow\": {\n                                \"action\": {\n                                    \"instructions\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"`Scan userless login QR`\"\n                                    },\n                                    \"metadata\": {\n                                        \"declaredVarTypes\": [\n                                            {\n                                                \"type_descriptor\": {\n                                                    \"schema\": {\n                                                        \"properties\": {\n                                                            \"qr_content\": {\n                                                                \"type\": \"string\"\n                                                            }\n                                                        }\n                                                    },\n                                                    \"type\": \"object\"\n                                                },\n                                                \"name\": \"ticketId\"\n                                            }\n                                        ],\n                                        \"type\": \"scan_qr\"\n                                    },\n                                    \"output_variable\": \"ticketId\",\n                                    \"type\": \"scan_qr\"\n                                },\n                                \"type\": \"action\",\n                                \"child\": {\n                                    \"action\": {\n                                        \"metadata\": {\n                                            \"declaredVarTypes\": [\n                                                {\n                                                    \"type_descriptor\": {\n                                                        \"schema\": {\n                                                            \"properties\": {\n                                                                \"system_params\": {\n                                                                    \"type\": \"object\",\n                                                                    \"properties\": {\n                                                                        \"issuing_app\": {\n                                                                            \"type\": \"string\"\n                                                                        },\n                                                                        \"issuing_policy\": {\n                                                                            \"type\": \"string\"\n                                                                        }\n                                                                    }\n                                                                },\n                                                                \"user_params\": {\n                                                                    \"type\": \"object\"\n                                                                }\n                                                            }\n                                                        },\n                                                        \"type\": \"object\"\n                                                    },\n                                                    \"name\": \"ticketInfo\"\n                                                }\n                                            ],\n                                            \"label\": \"Process ticket, supply user ID\",\n                                            \"type\": \"consume_ticket\"\n                                        },\n                                        \"output_variable\": \"ticketInfo\",\n                                        \"ticket_id\": {\n                                            \"type\": \"expression\",\n                                            \"value\": \"ticketId.qr_content\"\n                                        },\n                                        \"type\": \"consume_ticket\",\n                                        \"reply_parameters\": [\n                                            {\n                                                \"name\": \"user\",\n                                                \"value\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"@policy.user().id\"\n                                                }\n                                            }\n                                        ]\n                                    },\n                                    \"type\": \"action\",\n                                    \"child\": {\n                                        \"action\": {\n                                            \"metadata\": {\n                                                \"type\": \"auth_pass\"\n                                            },\n                                            \"type\": \"auth_pass\"\n                                        },\n                                        \"type\": \"action\"\n                                    }\n                                }\n                            },\n                            \"name\": \"scanqr2\",\n                            \"id\": \"810b5ca9-b347-4d14-aca1-78b6a681ae18\"\n                        }\n                    ],\n                    \"device_groups\": [\n                        {\n                            \"name\": \"PushGroup\",\n                            \"id\": \"8623\"\n                        },\n                        {\n                            \"name\": \"softtoken\",\n                            \"id\": \"c7081940-124b-406b-953e-66fc2c185e29\"\n                        },\n                        {\n                            \"name\": \"remember\",\n                            \"id\": \"5adae172-5f2a-418b-9a73-76ed8f707c89\"\n                        }\n                    ],\n                    \"name\": \"ImportedMobile Demo App\",\n                    \"crypto_session_config\": {\n                        \"mode\": \"off\"\n                    },\n                    \"reporting_config\": {\n                        \"policy_eval_reporting\": \"all\"\n                    },\n                    \"id\": \"importmobile_app\",\n                    \"categories\": [\n                        {\n                            \"name\": \"Something you know\",\n                            \"id\": \"765\"\n                        },\n                        {\n                            \"name\": \"Something you are\",\n                            \"id\": \"7908\"\n                        },\n                        {\n                            \"name\": \"Something you have\",\n                            \"id\": \"9595\"\n                        }\n                    ],\n                    \"fields\": null,\n                    \"providers\": {\n                        \"voice\": \"0e80ae3f-6e36-461d-9da8-960bbcb1cdc3\",\n                        \"sms\": \"a336b234-d1a1-4d33-b198-041f822fceb6\",\n                        \"user\": \"local-user-provider\",\n                        \"email\": \"417e609f-463c-4ca2-a473-da61050d7fc5\",\n                        \"push\": \"69b25589-a0d3-43eb-a554-64ae79ae4e78\"\n                    }\n                },\n                \"dependencies\": [],\n                \"constraints\": [\n                    {\n                        \"server_version\": \"4.3.3\",\n                        \"type\": \"server_version\"\n                    }\n                ]\n            }\n        ],\n        \"type\": \"application\"\n    }"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application/actions/import",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application",
						"actions",
						"import"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export Journey for App",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application/policies/actions/export?aid={{webaid}}&prid=enroll_to_push",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application",
						"policies",
						"actions",
						"export"
					],
					"query": [
						{
							"key": "aid",
							"value": "{{webaid}}"
						},
						{
							"key": "prid",
							"value": "enroll_to_push"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import Journey",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"items\" : [\n        {\n                \"data\": {\n                    \"policy_id\": \"setup_to_push\",\n                    \"versions\": [\n                        {\n                            \"version_id\": \"default_version\",\n                            \"desc\": \"default version\",\n                            \"state\": \"production\",\n                            \"workflow\": {\n                                \"action\": {\n                                    \"methods\": [\n                                        {\n                                            \"method\": {\n                                                \"instructions\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Message`\"\n                                                },\n                                                \"approval\": {\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Approve`\"\n                                                    },\n                                                    \"source\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Please`\"\n                                                    },\n                                                    \"details\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Details`\"\n                                                    },\n                                                    \"expires_in\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": 60\n                                                    },\n                                                    \"push_notification\": {\n                                                        \"send_params_on_push\": true,\n                                                        \"send_details_on_push\": true,\n                                                        \"type\": \"enabled\"\n                                                    },\n                                                    \"otp\": {\n                                                        \"type\": \"not_required\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"user_selection\": false,\n                                                        \"type\": \"all\"\n                                                    },\n                                                    \"mobile_app_id\": \"mobile_app\",\n                                                    \"mobile_policy_id\": \"Login_approval\",\n                                                    \"fail_if_no_bound_devices\": true\n                                                },\n                                                \"type\": \"mobile_approve\"\n                                            }\n                                        }\n                                    ],\n                                    \"options\": {\n                                        \"update_default\": true,\n                                        \"start_with\": \"default\"\n                                    },\n                                    \"strategy\": {\n                                        \"type\": \"primary\"\n                                    },\n                                    \"type\": \"authentication\"\n                                },\n                                \"type\": \"action\"\n                            },\n                            \"filter_criteria\": {\n                                \"type\": \"users\",\n                                \"value\": []\n                            },\n                            \"schema_version\": 2\n                        },\n                        {\n                            \"version_id\": \"asdf\",\n                            \"desc\": \"adf\",\n                            \"state\": \"disabled\",\n                            \"filter_criteria\": {\n                                \"type\": \"users\",\n                                \"value\": [\n                                    \"kurt\"\n                                ]\n                            },\n                            \"schema_version\": 2\n                        }\n                    ],\n                    \"type\": \"auth\",\n                    \"config\": {\n                        \"session_create\": true,\n                        \"session_validate\": false,\n                        \"token_create\": true\n                    },\n                    \"desc\": \"Enroll push\"\n                },\n                \"dependencies\": [],\n                \"constraints\": [\n                    {\n                        \"server_version\": \"4.0.2\",\n                        \"type\": \"server_version\"\n                    },\n                    {\n                        \"application_type\": \"web\",\n                        \"type\": \"application_type\"\n                    }\n                ]\n            }\n        ],\n        \"type\": \"policy\",\n    \"overwrite\": false\n}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application/policies/actions/import?aid={{webaid}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application",
						"policies",
						"actions",
						"import"
					],
					"query": [
						{
							"key": "aid",
							"value": "{{webaid}}"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export Journey Version for App",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application/policy/version/actions/export?aid={{webaid}}&prid=Login&vid=id1",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application",
						"policy",
						"version",
						"actions",
						"export"
					],
					"query": [
						{
							"key": "aid",
							"value": "{{webaid}}"
						},
						{
							"key": "prid",
							"value": "Login"
						},
						{
							"key": "vid",
							"value": "id1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import Journey Version",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": " {\n        \"items\": [\n            {\n                \"data\": {\n                    \"version_id\": \"idtest1\",\n                    \"desc\": \"login menu options and known device\",\n                    \"state\": \"disabled\",\n                    \"workflow\": {\n                        \"false_branch\": {\n                            \"action\": {\n                                \"metadata\": {\n                                    \"type\": \"information\"\n                                },\n                                \"text\": {\n                                    \"type\": \"expression\",\n                                    \"value\": \"`No mobile device`\"\n                                },\n                                \"button_text\": {\n                                    \"type\": \"expression\",\n                                    \"value\": \"`Continue`\"\n                                },\n                                \"title\": {\n                                    \"type\": \"expression\",\n                                    \"value\": \"`Information`\"\n                                },\n                                \"type\": \"information\",\n                                \"parameters\": []\n                            },\n                            \"type\": \"action\",\n                            \"child\": {\n                                \"action\": {\n                                    \"metadata\": {\n                                        \"type\": \"primary_authentication_menu\",\n                                        \"label\": \"Auth options\"\n                                    },\n                                    \"methods\": [\n                                        {\n                                            \"method\": {\n                                                \"channels\": [\n                                                    {\n                                                        \"from\": \"Transmit\",\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please use this code: %otp%`\"\n                                                        },\n                                                        \"type\": \"sms\",\n                                                        \"target\": {\n                                                            \"type\": \"user\",\n                                                            \"value\": \"$.mobile\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please use this code: %otp%`\"\n                                                        },\n                                                        \"language\": {\n                                                            \"type\": \"static\",\n                                                            \"value\": \"en-AU\"\n                                                        },\n                                                        \"from\": \"Transmit\",\n                                                        \"target\": {\n                                                            \"type\": \"user\",\n                                                            \"value\": \"$.mobile\"\n                                                        },\n                                                        \"type\": \"voice\"\n                                                    }\n                                                ],\n                                                \"otp_provider_config\": {\n                                                    \"length\": 4\n                                                },\n                                                \"failures_strategy\": {\n                                                    \"type\": \"wrong_inputs_only\"\n                                                },\n                                                \"auto_execute\": false,\n                                                \"type\": \"otp\",\n                                                \"otp_provider_id\": \"otp-internal-hotp\"\n                                            }\n                                        },\n                                        {\n                                            \"method\": {\n                                                \"device_selection_strategy\": {\n                                                    \"user_selection\": false,\n                                                    \"type\": \"all\"\n                                                },\n                                                \"type\": \"totp\"\n                                            }\n                                        },\n                                        {\n                                            \"method\": {\n                                                \"type\": \"pin_centralized\"\n                                            }\n                                        },\n                                        {\n                                            \"method\": {\n                                                \"type\": \"pattern_centralized\"\n                                            }\n                                        },\n                                        {\n                                            \"method\": {\n                                                \"type\": \"password\"\n                                            }\n                                        }\n                                    ],\n                                    \"options\": {\n                                        \"start_in_menu\": true,\n                                        \"update_default\": true,\n                                        \"start_with\": \"menu\"\n                                    },\n                                    \"strategy\": {\n                                        \"type\": \"primary\"\n                                    },\n                                    \"type\": \"authentication\"\n                                },\n                                \"type\": \"action\"\n                            }\n                        },\n                        \"condition\": {\n                            \"negated\": false,\n                            \"metadata\": {\n                                \"type\": \"bound_device\"\n                            },\n                            \"type\": \"bound_device\",\n                            \"application_id\": \"mobile_app\"\n                        },\n                        \"true_branch\": {\n                            \"false_branch\": {\n                                \"action\": {\n                                    \"metadata\": {\n                                        \"type\": \"information\"\n                                    },\n                                    \"text\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"`We've identified this as a new device, please have your mobile phone ready to complete authentication`\"\n                                    },\n                                    \"button_text\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"`Continue`\"\n                                    },\n                                    \"title\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"`Information`\"\n                                    },\n                                    \"type\": \"information\",\n                                    \"parameters\": []\n                                },\n                                \"type\": \"action\",\n                                \"child\": {\n                                    \"action\": {\n                                        \"metadata\": {\n                                            \"type\": \"primary_authentication_menu\",\n                                            \"declaredVarTypes\": [\n                                                {\n                                                    \"type_descriptor\": {\n                                                        \"type\": \"object\",\n                                                        \"schema\": {\n                                                            \"properties\": {\n                                                                \"level\": {\n                                                                    \"type\": \"int\"\n                                                                },\n                                                                \"raw_data\": {\n                                                                    \"type\": \"object\"\n                                                                },\n                                                                \"method\": {\n                                                                    \"type\": \"string\"\n                                                                }\n                                                            }\n                                                        }\n                                                    },\n                                                    \"name\": \"authUsed\"\n                                                }\n                                            ],\n                                            \"label\": \"Auth options\"\n                                        },\n                                        \"methods\": [\n                                            {\n                                                \"method\": {\n                                                    \"instructions\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Please check mobile device`\"\n                                                    },\n                                                    \"approval\": {\n                                                        \"title\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Transmit Web Login Request`\"\n                                                        },\n                                                        \"source\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Transmit Web Login Request`\"\n                                                        },\n                                                        \"details\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please approve the web login by ${@policy.user().id} from ${@policy.device().hw_details.device_model}.`\"\n                                                        },\n                                                        \"expires_in\": {\n                                                            \"type\": \"static\",\n                                                            \"value\": \"360\"\n                                                        },\n                                                        \"push_notification\": {\n                                                            \"send_params_on_push\": true,\n                                                            \"send_details_on_push\": true,\n                                                            \"type\": \"enabled\"\n                                                        },\n                                                        \"otp\": {\n                                                            \"type\": \"not_required\"\n                                                        },\n                                                        \"strategy\": {\n                                                            \"user_selection\": true,\n                                                            \"type\": \"all\"\n                                                        },\n                                                        \"mobile_app_id\": \"mobile_app\",\n                                                        \"mobile_policy_id\": \"MobileAuth_approval\",\n                                                        \"fail_if_no_bound_devices\": true\n                                                    },\n                                                    \"type\": \"mobile_approve\"\n                                                }\n                                            }\n                                        ],\n                                        \"options\": {\n                                            \"update_default\": false,\n                                            \"start_with\": \"default\"\n                                        },\n                                        \"strategy\": {\n                                            \"type\": \"primary\"\n                                        },\n                                        \"type\": \"authentication\",\n                                        \"var_name\": \"authUsed\"\n                                    },\n                                    \"type\": \"action\"\n                                }\n                            },\n                            \"condition\": {\n                                \"negated\": false,\n                                \"metadata\": {\n                                    \"type\": \"device_id\"\n                                },\n                                \"check\": [\n                                    \"registered\",\n                                    \"unregistered\"\n                                ],\n                                \"type\": \"device_fingerprint\"\n                            },\n                            \"true_branch\": {\n                                \"action\": {\n                                    \"metadata\": {\n                                        \"type\": \"primary_authentication_menu\",\n                                        \"declaredVarTypes\": [\n                                            {\n                                                \"type_descriptor\": {\n                                                    \"type\": \"object\",\n                                                    \"schema\": {\n                                                        \"properties\": {\n                                                            \"level\": {\n                                                                \"type\": \"int\"\n                                                            },\n                                                            \"raw_data\": {\n                                                                \"type\": \"object\"\n                                                            },\n                                                            \"method\": {\n                                                                \"type\": \"string\"\n                                                            }\n                                                        }\n                                                    }\n                                                },\n                                                \"name\": \"authUsed\"\n                                            }\n                                        ],\n                                        \"label\": \"Auth options\"\n                                    },\n                                    \"methods\": [\n                                        {\n                                            \"method\": {\n                                                \"channels\": [\n                                                    {\n                                                        \"from\": \"Transmit\",\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please use this code: %otp%`\"\n                                                        },\n                                                        \"type\": \"sms\",\n                                                        \"target\": {\n                                                            \"type\": \"user\",\n                                                            \"value\": \"$.mobile\"\n                                                        }\n                                                    },\n                                                    {\n                                                        \"text\": {\n                                                            \"type\": \"expression\",\n                                                            \"value\": \"`Please use this code: %otp%`\"\n                                                        },\n                                                        \"language\": {\n                                                            \"type\": \"static\",\n                                                            \"value\": \"en-AU\"\n                                                        },\n                                                        \"from\": \"Transmit\",\n                                                        \"target\": {\n                                                            \"type\": \"user\",\n                                                            \"value\": \"$.mobile\"\n                                                        },\n                                                        \"type\": \"voice\"\n                                                    }\n                                                ],\n                                                \"otp_provider_config\": {\n                                                    \"length\": 4\n                                                },\n                                                \"failures_strategy\": {\n                                                    \"type\": \"wrong_inputs_only\"\n                                                },\n                                                \"auto_execute\": false,\n                                                \"type\": \"otp\",\n                                                \"otp_provider_id\": \"otp-internal-hotp\"\n                                            }\n                                        },\n                                        {\n                                            \"method\": {\n                                                \"device_selection_strategy\": {\n                                                    \"user_selection\": false,\n                                                    \"type\": \"all\"\n                                                },\n                                                \"type\": \"totp\"\n                                            }\n                                        },\n                                        {\n                                            \"method\": {\n                                                \"type\": \"pattern_centralized\"\n                                            }\n                                        },\n                                        {\n                                            \"method\": {\n                                                \"instructions\": {\n                                                    \"type\": \"expression\",\n                                                    \"value\": \"`Please check mobile device`\"\n                                                },\n                                                \"approval\": {\n                                                    \"title\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Transmit Web Login Request`\"\n                                                    },\n                                                    \"source\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Transmit Web Login Request`\"\n                                                    },\n                                                    \"details\": {\n                                                        \"type\": \"expression\",\n                                                        \"value\": \"`Please approve the web login by ${@policy.user().id} from ${@policy.device().hw_details.device_model}.`\"\n                                                    },\n                                                    \"expires_in\": {\n                                                        \"type\": \"static\",\n                                                        \"value\": \"360\"\n                                                    },\n                                                    \"push_notification\": {\n                                                        \"send_params_on_push\": true,\n                                                        \"send_details_on_push\": true,\n                                                        \"type\": \"enabled\"\n                                                    },\n                                                    \"otp\": {\n                                                        \"type\": \"not_required\"\n                                                    },\n                                                    \"strategy\": {\n                                                        \"user_selection\": false,\n                                                        \"type\": \"all\"\n                                                    },\n                                                    \"mobile_app_id\": \"mobile_app\",\n                                                    \"mobile_policy_id\": \"MobileAuth_approval\",\n                                                    \"fail_if_no_bound_devices\": true\n                                                },\n                                                \"type\": \"mobile_approve\"\n                                            }\n                                        }\n                                    ],\n                                    \"options\": {\n                                        \"start_in_menu\": true,\n                                        \"update_default\": false,\n                                        \"start_with\": \"menu\"\n                                    },\n                                    \"strategy\": {\n                                        \"type\": \"primary\"\n                                    },\n                                    \"type\": \"authentication\",\n                                    \"var_name\": \"authUsed\"\n                                },\n                                \"type\": \"action\"\n                            },\n                            \"otherwise_branch\": {\n                                \"action\": {\n                                    \"clear_session\": true,\n                                    \"metadata\": {\n                                        \"type\": \"reject\"\n                                    },\n                                    \"type\": \"reject\"\n                                },\n                                \"type\": \"action\"\n                            },\n                            \"type\": \"condition\"\n                        },\n                        \"type\": \"condition\"\n                    },\n                    \"schema_version\": 2\n                },\n                \"dependencies\": [],\n                \"constraints\": [\n                    {\n                        \"server_version\": \"4.0.2\",\n                        \"type\": \"server_version\"\n                    },\n                    {\n                        \"application_type\": \"web\",\n                        \"type\": \"application_type\"\n                    },\n                    {\n                        \"policy_type\": \"auth\",\n                        \"type\": \"policy_type\"\n                    }\n                ]\n            }\n        ],\n        \"type\": \"policy_version\",\n        \"overwrite\": false\n    }"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application/policy/version/actions/import?aid={{webaid}}&prid=Login",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application",
						"policy",
						"version",
						"actions",
						"import"
					],
					"query": [
						{
							"key": "aid",
							"value": "{{webaid}}"
						},
						{
							"key": "prid",
							"value": "Login"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Promote Journey to Production",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application/policy/version/promote?aid=webapp&prid=Login&vid=id1",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application",
						"policy",
						"version",
						"promote"
					],
					"query": [
						{
							"key": "aid",
							"value": "webapp"
						},
						{
							"key": "prid",
							"value": "Login"
						},
						{
							"key": "vid",
							"value": "id1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export Administrators",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"new_user_id\":\"new1\"\n}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/administrators/actions/export",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"administrators",
						"actions",
						"export"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import Administrators",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"items\": [\n    {\n            \"id\": \"demo2\",\n            \"permissions\": [\n                {\n                    \"type\": \"mng-ui-admin\"\n                }\n            ],\n            \"hash\": \"FvNKS1kdK4sQIzE+yjY7T6AU3mdWEHZF61TRATe4ql15GXW57lzm8VwWkC5zDX8PAeBpFBJQDfNGeJf3wPKONw==\",\n            \"salt\": \"a1ff33b2-55de-4107-a215-deb8f9c55511\"\n        }\n  ],\n  \"overwrite\": false\n}"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/administrators/actions/import",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"administrators",
						"actions",
						"import"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Export Access Management Rules",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"new_user_id\":\"new1\"\n}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/access/resources/actions/export",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"access",
						"resources",
						"actions",
						"export"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Import Access Management Rules",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"items\": [\n           {\n                \"data\": {\n                    \"underlying\": [\n                        {\n                            \"description\": \"Logout rule\",\n                            \"uri_pattern\": \".*/sso/app-logout\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"ALL\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"23467313-2365-40c2-9afa-d958a5aad536\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"Allow access to logo without authentication\",\n                            \"uri_pattern\": \".*/sso/assets/logo.*\\\\.jpg\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"ALL\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"a769be48-f69c-412a-a5c5-b6d7a103f479\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"Assets rule\",\n                            \"uri_pattern\": \".*/sso/assets/.*\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"g:docker_opendj:cn=programmers,ou=groups,dc=transmit,dc=com\",\n                                        \"g:ts_user_managment:programmers\",\n                                        \"u:test\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"79b501ac-b0b0-405b-8f4f-41e1d68d7f0c\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"Step up rule\",\n                            \"uri_pattern\": \".*/sso/stepup\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"g:docker_opendj:cn=programmers,ou=groups,dc=transmit,dc=com\",\n                                        \"g:ts_user_managment:programmers\",\n                                        \"u:test\"\n                                    ],\n                                    \"criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"@access.environment().session.sessionData.loa < 3\"\n                                    },\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"policy_id\": \"step_up\",\n                                        \"type\": \"redirect\",\n                                        \"application_id\": \"idp\"\n                                    }\n                                },\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"g:docker_opendj:cn=programmers,ou=groups,dc=transmit,dc=com\",\n                                        \"g:ts_user_managment:programmers\",\n                                        \"u:test\"\n                                    ],\n                                    \"criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"@access.environment().session.sessionData.loa >= 3\"\n                                    },\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"364b2260-1a6a-11e9-b56e-0800200c9a66\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"Edit profile step up\",\n                            \"uri_pattern\": \".*/sso/editprofile\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"g:docker_opendj:cn=programmers,ou=groups,dc=transmit,dc=com\",\n                                        \"g:ts_user_managment:programmers\",\n                                        \"u:test\"\n                                    ],\n                                    \"criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"@access.environment().session.sessionData.loa < 3\"\n                                    },\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"policy_id\": \"step_up\",\n                                        \"type\": \"redirect\",\n                                        \"application_id\": \"idp\"\n                                    }\n                                },\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"g:docker_opendj:cn=programmers,ou=groups,dc=transmit,dc=com\",\n                                        \"g:ts_user_managment:programmers\",\n                                        \"u:test\"\n                                    ],\n                                    \"criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"@access.environment().session.sessionData.loa >= 3\"\n                                    },\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"87f34102-aa7f-4987-b03b-a39a9738f1c4\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"Login rule\",\n                            \"uri_pattern\": \".*/sso/.*\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"g:docker_opendj:cn=programmers,ou=groups,dc=transmit,dc=com\",\n                                        \"g:ts_user_managment:programmers\",\n                                        \"u:test\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                },\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"NONE\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"policy_id\": \"Login\",\n                                        \"type\": \"redirect\",\n                                        \"application_id\": \"idp\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"49367313-2365-40c2-9afa-d958a5aad122\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"Echo server TSPEP - one rule to rule themall\",\n                            \"uri_pattern\": \".*/tspep/protected/.*\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"u:allow\",\n                                        \"u:test\"\n                                    ],\n                                    \"criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"@access.invokeAuthenticationJourney(\\\"pdp2j\\\", \\\"default\\\",{}).allow\"\n                                    },\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                },\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"u:deny\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"data\": \"/tspep/deny-callback\",\n                                        \"type\": \"deny\"\n                                    }\n                                },\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"u:redirect\",\n                                        \"NONE\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"policy_id\": \"Login\",\n                                        \"type\": \"redirect\",\n                                        \"application_id\": \"idp\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"18ecdcb4-84fb-47c3-9272-74b93054bd02\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"j2pdp and pdp2j\",\n                            \"uri_pattern\": \".*/xjpdp/.*\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"u:test\",\n                                        \"g:ts_user_managment:programmers\"\n                                    ],\n                                    \"criteria\": {\n                                        \"type\": \"expression\",\n                                        \"value\": \"@access.invokeAuthenticationJourney(\\\"pdp2j\\\", \\\"default\\\",{}).allow\"\n                                    },\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                },\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"u:test\",\n                                        \"g:ts_user_managment:programmers\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"post\"\n                                        },\n                                        {\n                                            \"type\": \"get\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"data\": \"http://deny.io.403.html\",\n                                        \"type\": \"deny\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"58dc34ac-99b5-42ea-af81-5b9750cf0b7d\",\n                            \"type\": \"uri_pattern\"\n                        },\n                        {\n                            \"description\": \"Allow dilithium\",\n                            \"uri_pattern\": \".*/dilithium/.*\",\n                            \"rules\": [\n                                {\n                                    \"rule_id\": \"\",\n                                    \"principals\": [\n                                        \"ALL\"\n                                    ],\n                                    \"privileges\": [\n                                        {\n                                            \"type\": \"get\"\n                                        },\n                                        {\n                                            \"type\": \"post\"\n                                        }\n                                    ],\n                                    \"result\": {\n                                        \"type\": \"allow\"\n                                    }\n                                }\n                            ],\n                            \"id\": \"48bb8295-d41c-4bf7-a3a5-e6122107e6a3\",\n                            \"type\": \"uri_pattern\"\n                        }\n                    ]\n                },\n                \"dependencies\": [],\n                \"constraints\": [\n                    {\n                        \"server_version\": \"5.0.0\",\n                        \"type\": \"server_version\"\n                    }\n                ]\n            }\n  ],\n        \"type\": \"Resources\",\n        \"overwrite\": false\n}"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/access/resources/actions/import",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"access",
						"resources",
						"actions",
						"import"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops -Duplicate App",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"id\": \"new1\",\n    \"new_id\": \"new3\",\n    \"name\": \"new app name\"\n}"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/applications/actions/duplicate",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"applications",
						"actions",
						"duplicate"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Application Definition settings",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"name\":\"new1\",\"providers\":{\"user\":\"local-user-provider\",\"sms\":\"09295c1e-195b-444c-9a3e-48df37bca914\",\"voice\":\"0e80ae3f-6e36-461d-9da8-960bbcb1cdc3\"},\"token_config\":{\"expiry\":{\"reg\":1800,\"pld\":1800,\"auth\":1800,\"cfg\":1800,\"act\":1800},\"local\":{\"alias\":\"JwtKey\",\"version\":\"1\",\"provider_type\":\"db\",\"type\":\"local\"},\"trusted\":{\"alias\":\"JwtCert\",\"version\":\"1\",\"provider_type\":\"db\",\"type\":\"trusted\"},\"default_strategy\":\"sign_and_encrypt\",\"type\":\"pki\"},\"crypto_session_config\":{\"mode\":\"off\"},\"id\":\"new1\"}"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/application?aid=new1",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"application"
					],
					"query": [
						{
							"key": "aid",
							"value": "new1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Get Admin Log Records",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"new_user_id\":\"new1\"\n}\n"
				},
				"url": {
					"raw": "{{url}}/api/v2/mng/reports/management?limit=100&skip=&from=1537104360000&to={{$timestamp}}000",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"reports",
						"management"
					],
					"query": [
						{
							"key": "limit",
							"value": "100"
						},
						{
							"key": "skip",
							"value": ""
						},
						{
							"key": "from",
							"value": "1537104360000"
						},
						{
							"key": "to",
							"value": "{{$timestamp}}000"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Device State",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"collection_result\":{\"metadata\":{\"timestamp\":{{$timestamp}}},\"content\":{\"device_details\":{\"device_id\":\"98a7b7e753ae9dec28afc4cfed11a36f\",\"os_type\":\"Mac OS\",\"os_version\":\"10.12.6\",\"device_model\":\"Chrome 67.0.3325.181\",\"device_platform\":\"MacIntel\",\"tampered\":false,\"timezone_offset\":420},\"location\":{\"enabled\":true,\"error\":\"permission_denied\"}},\"collector_version\":\"1.0.0\",\"local_ip\":{\"__err__\":\"Timeout\"},\"cpu_cores\":4,\"fp2_hash\":\"5843e7857c7096c2f336daadc0548c6c\",\"fp2_keys\":{\"user_agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\",\"language\":\"en-US\",\"color_depth\":24,\"pixel_ratio\":2,\"resolution\":[1920,1080],\"available_resolution\":[1920,1016],\"timezone_offset\":420,\"session_storage\":1,\"local_storage\":1,\"indexed_db\":1,\"open_database\":1,\"cpu_class\":\"unknown\",\"navigator_platform\":\"MacIntel\",\"do_not_track\":\"1\",\"regular_plugins\":[\"Chrome PDF Plugin::Portable Document Format::application/x-google-chrome-pdf~pdf\",\"Chrome PDF Viewer::::application/pdf~pdf\"],\"canvas\":\"cw:1~7f8d186a072fd0bbee87402499708ac6\",\"webgl\":{\"canvas\":\"fddd5b30f655d479d8986be0fe2fe3cf\",\"xt\":\"ANGLE_instanced_arrays;EXT_blend_minmax;EXT_color_buffer_half_float;EXT_frag_depth;EXT_shader_texture_lod;EXT_texture_filter_anisotropic;WEBKIT_EXT_texture_filter_anisotropic;EXT_sRGB;OES_element_index_uint;OES_standard_derivatives;OES_texture_float;OES_texture_float_linear;OES_texture_half_float;OES_texture_half_float_linear;OES_vertex_array_object;WEBGL_color_buffer_float;WEBGL_compressed_texture_s3tc;WEBKIT_WEBGL_compressed_texture_s3tc;WEBGL_compressed_texture_s3tc_srgb;WEBGL_debug_renderer_info;WEBGL_debug_shaders;WEBGL_depth_texture;WEBKIT_WEBGL_depth_texture;WEBGL_draw_buffers;WEBGL_lose_context;WEBKIT_WEBGL_lose_context\",\"alwr\":\"[1, 1]\",\"apsr\":\"[1, 255.875]\",\"ab\":8,\"aa\":\"yes\",\"bb\":8,\"db\":24,\"gb\":8,\"ai\":16,\"mctiu\":80,\"cmts\":16384,\"mfuv\":1024,\"mrbs\":16384,\"mtiu\":16,\"mts\":16384,\"mvv\":15,\"mva\":16,\"mvtiu\":16,\"mvuv\":1024,\"mvd\":\"[16384, 16384]\",\"rb\":8,\"rr\":\"WebKit WebGL\",\"slv\":\"WebGL GLSL ES 1.0 (OpenGL ES GLSL ES 1.0 Chromium)\",\"stb\":0,\"vendor\":\"WebKit\",\"version\":\"WebGL 1.0 (OpenGL ES 2.0 Chromium)\",\"vshfp\":23,\"vshfprmin\":127,\"vshfprmax\":127,\"vsmfp\":23,\"vsmfprmin\":127,\"vsmfprmax\":127,\"vslfp\":23,\"vslfprmin\":127,\"vslfprmax\":127,\"fshfp\":23,\"fshfprmin\":127,\"fshfprmax\":127,\"fsmfp\":23,\"fsmfprmin\":127,\"fsmfprmax\":127,\"fslfp\":23,\"fslfprmin\":127,\"fslfprmax\":127,\"vship\":0,\"vshiprmin\":31,\"vshiprmax\":30,\"vsmip\":0,\"vsmiprmin\":31,\"vsmiprmax\":30,\"vslip\":0,\"vsliprmin\":31,\"vsliprmax\":30,\"fship\":0,\"fshiprmin\":31,\"fshiprmax\":30,\"fsmip\":0,\"fsmiprmin\":31,\"fsmiprmax\":30,\"fslip\":0,\"fsliprmin\":31,\"fsliprmax\":30},\"adblock\":false,\"has_lied_languages\":false,\"has_lied_resolution\":false,\"has_lied_os\":false,\"has_lied_browser\":false,\"touch_support\":[0,false,false],\"js_fonts\":[\"Andale Mono\",\"Arial\",\"Arial Black\",\"Arial Hebrew\",\"Arial Narrow\",\"Arial Rounded MT Bold\",\"Arial Unicode MS\",\"Comic Sans MS\",\"Courier\",\"Courier New\",\"Geneva\",\"Georgia\",\"Helvetica\",\"Helvetica Neue\",\"Impact\",\"LUCIDA GRANDE\",\"Microsoft Sans Serif\",\"Monaco\",\"Palatino\",\"Tahoma\",\"Times\",\"Times New Roman\",\"Trebuchet MS\",\"Verdana\",\"Wingdings\",\"Wingdings 2\",\"Wingdings 3\"]}}}"
				},
				"url": {
					"raw": "{{url}}/api/v2/rest/device_state?uid={{uid}}&aid={{webaid}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"rest",
						"device_state"
					],
					"query": [
						{
							"key": "uid",
							"value": "{{uid}}"
						},
						{
							"key": "aid",
							"value": "{{webaid}}"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Get System Settings",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					}
				],
				"body": {},
				"url": {
					"raw": "{{url}}/api/v2/mng/settings",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"mng",
						"settings"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Server Version",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {},
				"url": {
					"raw": "{{url}}/version",
					"host": [
						"{{url}}"
					],
					"path": [
						"version"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Server Status",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken status; tid=status",
						"disabled": true
					},
					{
						"key": "Content-Type",
						"value": "application/json",
						"disabled": true
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{url}}/api/v2/status",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"status"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ops - Get JWKS entries",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "TSToken {{tstoken}}; tid={{tid}}"
					},
					{
						"key": "Content-Type",
						"value": "application/json",
						"disabled": true
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"assertion_id\":\"mZ2Q23f2GyPM2VeCsbhR/jtI\",\n\t\"action\":\"authentication\",\n\t\"method\":\"mobile_approve\",\n\t\"assert\":\"authenticate\",\n\t\"data\":{\n\t\t\"approval_id\":\"6cdbc40d-c1a1-4f16-a105-47f1b05168c6\"},\n\t \"fch\":\"Qp26fdhxYVdQMy8xM/541+f2\"\n}"
				},
				"url": {
					"raw": "{{url}}/api/v2/token/jwks",
					"host": [
						"{{url}}"
					],
					"path": [
						"api",
						"v2",
						"token",
						"jwks"
					]
				}
			},
			"response": []
		}
	]
}